<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-
  This module based on System.FilePath.Internal of file-path.
  The code was copied with the permission from the author
  of file-path, Neil Mitchell. Thanks!
  See the copyright at the end of file.
-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.EasyFile.FilePath</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>    </span><span class="hs-comment">-- * Separator predicates</span><span>
</span><a name="line-12"></a><span>    </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>    </span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#pathSeparators"><span class="hs-identifier hs-var">pathSeparators</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span class="hs-comment">{- xxx
    searchPathSeparator, isSearchPathSeparator,
-}</span><span>
</span><a name="line-17"></a><span>    </span><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier hs-var">extSeparator</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-comment">{- xxx
    -- * Path methods (environment $PATH)
    splitSearchPath, getSearchPath,
-}</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-comment">-- * Extension methods</span><span>
</span><a name="line-25"></a><span>    </span><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier hs-var">splitExtension</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>    </span><a href="System.EasyFile.FilePath.html#takeExtension"><span class="hs-identifier hs-var">takeExtension</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#replaceExtension"><span class="hs-identifier hs-var">replaceExtension</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier hs-var">dropExtension</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#addExtension"><span class="hs-identifier hs-var">addExtension</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#hasExtension"><span class="hs-identifier hs-var">hasExtension</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>    </span><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier hs-var">splitExtensions</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#dropExtensions"><span class="hs-identifier hs-var">dropExtensions</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#takeExtensions"><span class="hs-identifier hs-var">takeExtensions</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-comment">-- * Drive methods</span><span>
</span><a name="line-30"></a><span>    </span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-var">joinDrive</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>    </span><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-var">takeDrive</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier hs-var">hasDrive</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier hs-var">dropDrive</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-var">isDrive</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-comment">-- * Operations on a FilePath, as a list of directories</span><span>
</span><a name="line-34"></a><span>    </span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>    </span><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#replaceFileName"><span class="hs-identifier hs-var">replaceFileName</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier hs-var">dropFileName</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>    </span><a href="System.EasyFile.FilePath.html#takeBaseName"><span class="hs-identifier hs-var">takeBaseName</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#replaceBaseName"><span class="hs-identifier hs-var">replaceBaseName</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>    </span><a href="System.EasyFile.FilePath.html#takeDirectory"><span class="hs-identifier hs-var">takeDirectory</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#replaceDirectory"><span class="hs-identifier hs-var">replaceDirectory</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>    </span><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier hs-var">combine</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>    </span><a href="System.EasyFile.FilePath.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#joinPath"><span class="hs-identifier hs-var">joinPath</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#splitDirectories"><span class="hs-identifier hs-var">splitDirectories</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-comment">-- * Low level FilePath operators</span><span>
</span><a name="line-42"></a><span>    </span><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier hs-var">hasTrailingPathSeparator</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>    </span><a href="System.EasyFile.FilePath.html#addTrailingPathSeparator"><span class="hs-identifier hs-var">addTrailingPathSeparator</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>    </span><a href="System.EasyFile.FilePath.html#dropTrailingPathSeparator"><span class="hs-identifier hs-var">dropTrailingPathSeparator</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-comment">-- * File name manipulators</span><span>
</span><a name="line-47"></a><span>    </span><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier hs-var">equalFilePath</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>    </span><a href="System.EasyFile.FilePath.html#makeRelative"><span class="hs-identifier hs-var">makeRelative</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>    </span><a href="System.EasyFile.FilePath.html#isRelative"><span class="hs-identifier hs-var">isRelative</span></a><span class="hs-special">,</span><span> </span><a href="System.EasyFile.FilePath.html#isAbsolute"><span class="hs-identifier hs-var">isAbsolute</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span class="hs-comment">{- xxx
    isValid, makeValid
-}</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isRelativeDrive</span><span>
</span><a name="line-56"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span class="hs-special">(</span><span class="hs-identifier hs-var">toLower</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toUpper</span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- import System.Environment(getEnv) -- xxx</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">7</span><span>  </span><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span>
</span><a name="line-68"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span>  </span><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- Platform Abstraction Methods (private)</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Is the operating system Unix or Linux like</span><span>
</span><a name="line-78"></a><span class="hs-identifier">isPosix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-79"></a><a name="isPosix"><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier">isPosix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier hs-var">isWindows</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | Is the operating system Windows like</span><span>
</span><a name="line-82"></a><span class="hs-identifier">isWindows</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-83"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS) || defined(__MINGW32__)
</span><span class="hs-identifier">isWindows</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><a name="line-85"></a><span class="hs-cpp">#else
</span><a name="isWindows"><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier">isWindows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-87"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-89"></a><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- The basic functions</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">-- | The character that separates directories.</span><span>
</span><a name="line-93"></a><span class="hs-comment">--</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- &gt; pathSeparator ==  '/'</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- &gt; isPathSeparator pathSeparator</span><span>
</span><a name="line-96"></a><span class="hs-identifier">pathSeparator</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-97"></a><a name="pathSeparator"><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier">pathSeparator</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'/'</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- | The list of all possible separators.</span><span>
</span><a name="line-100"></a><span class="hs-comment">--</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- &gt; Windows: pathSeparators == ['\\', '/']</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- &gt; Posix:   pathSeparators == ['/']</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- &gt; pathSeparator `elem` pathSeparators</span><span>
</span><a name="line-104"></a><span class="hs-identifier">pathSeparators</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-105"></a><a name="pathSeparators"><a href="System.EasyFile.FilePath.html#pathSeparators"><span class="hs-identifier">pathSeparators</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier hs-var">isWindows</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;\\/&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;/&quot;</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | Rather than using @(== 'pathSeparator')@, use this. Test if something</span><span>
</span><a name="line-108"></a><span class="hs-comment">--   is a path separator.</span><span>
</span><a name="line-109"></a><span class="hs-comment">--</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- &gt; isPathSeparator a == (a `elem` pathSeparators)</span><span>
</span><a name="line-111"></a><span class="hs-identifier">isPathSeparator</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-112"></a><a name="isPathSeparator"><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier">isPathSeparator</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="System.EasyFile.FilePath.html#pathSeparators"><span class="hs-identifier hs-var">pathSeparators</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">{- xxx
-- | The character that is used to separate the entries in the $PATH environment variable.
--
-- &gt; Windows: searchPathSeparator == ';'
-- &gt; Posix:   searchPathSeparator == ':'
searchPathSeparator :: Char
searchPathSeparator = if isWindows then ';' else ':'

-- | Is the character a file separator?
--
-- &gt; isSearchPathSeparator a == (a == searchPathSeparator)
isSearchPathSeparator :: Char -&gt; Bool
isSearchPathSeparator = (== searchPathSeparator)
-}</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- | File extension character</span><span>
</span><a name="line-131"></a><span class="hs-comment">--</span><span>
</span><a name="line-132"></a><span class="hs-comment">-- &gt; extSeparator == '.'</span><span>
</span><a name="line-133"></a><span class="hs-identifier">extSeparator</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-134"></a><a name="extSeparator"><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier">extSeparator</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'.'</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Is the character an extension character?</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- &gt; isExtSeparator a == (a == extSeparator)</span><span>
</span><a name="line-139"></a><span class="hs-identifier">isExtSeparator</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-140"></a><a name="isExtSeparator"><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier">isExtSeparator</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier hs-var">extSeparator</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">{- xxx
---------------------------------------------------------------------
-- Path methods (environment $PATH)

-- | Take a string, split it on the 'searchPathSeparator' character.
--
--   Follows the recommendations in
--   &lt;http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html&gt;
--
-- &gt; Posix:   splitSearchPath &quot;File1:File2:File3&quot;  == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]
-- &gt; Posix:   splitSearchPath &quot;File1::File2:File3&quot; == [&quot;File1&quot;,&quot;.&quot;,&quot;File2&quot;,&quot;File3&quot;]
-- &gt; Windows: splitSearchPath &quot;File1;File2;File3&quot;  == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]
-- &gt; Windows: splitSearchPath &quot;File1;;File2;File3&quot; == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]
splitSearchPath :: String -&gt; [FilePath]
splitSearchPath = f
    where
    f xs = case break isSearchPathSeparator xs of
           (pre, []    ) -&gt; g pre
           (pre, _:post) -&gt; g pre ++ f post

    g &quot;&quot; = [&quot;.&quot; | isPosix]
    g x = [x]


-- | Get a list of filepaths in the $PATH.
getSearchPath :: IO [FilePath]
getSearchPath = fmap splitSearchPath (getEnv &quot;PATH&quot;)
-}</span><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- Extension methods</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- | Split on the extension. 'addExtension' is the inverse.</span><span>
</span><a name="line-178"></a><span class="hs-comment">--</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- &gt; uncurry (++) (splitExtension x) == x</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- &gt; uncurry addExtension (splitExtension x) == x</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- &gt; splitExtension &quot;file.txt&quot; == (&quot;file&quot;,&quot;.txt&quot;)</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- &gt; splitExtension &quot;file&quot; == (&quot;file&quot;,&quot;&quot;)</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- &gt; splitExtension &quot;file/file.txt&quot; == (&quot;file/file&quot;,&quot;.txt&quot;)</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- &gt; splitExtension &quot;file.txt/boris&quot; == (&quot;file.txt/boris&quot;,&quot;&quot;)</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- &gt; splitExtension &quot;file.txt/boris.ext&quot; == (&quot;file.txt/boris&quot;,&quot;.ext&quot;)</span><span>
</span><a name="line-186"></a><span class="hs-comment">-- &gt; splitExtension &quot;file/path.txt.bob.fred&quot; == (&quot;file/path.txt.bob&quot;,&quot;.fred&quot;)</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- &gt; splitExtension &quot;file/path.txt/&quot; == (&quot;file/path.txt/&quot;,&quot;&quot;)</span><span>
</span><a name="line-188"></a><span class="hs-identifier">splitExtension</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-189"></a><a name="splitExtension"><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier">splitExtension</span></a></a><span> </span><a name="local-6989586621679031263"><a href="#local-6989586621679031263"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031267"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-190"></a><span>                       </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031263"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>                       </span><span class="hs-special">(</span><a name="local-6989586621679031454"><a href="#local-6989586621679031454"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031455"><a href="#local-6989586621679031455"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031264"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031455"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031454"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031266"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-193"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031264"><a href="#local-6989586621679031264"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031265"><a href="#local-6989586621679031265"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a><span> </span><a href="#local-6989586621679031263"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-194"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031266"><a href="#local-6989586621679031266"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031267"><a href="#local-6989586621679031267"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031265"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- | Get the extension of a file, returns @\&quot;\&quot;@ for no extension, @.ext@ otherwise.</span><span>
</span><a name="line-197"></a><span class="hs-comment">--</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- &gt; takeExtension x == snd (splitExtension x)</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- &gt; Valid x =&gt; takeExtension (addExtension x &quot;ext&quot;) == &quot;.ext&quot;</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- &gt; Valid x =&gt; takeExtension (replaceExtension x &quot;ext&quot;) == &quot;.ext&quot;</span><span>
</span><a name="line-201"></a><span class="hs-identifier">takeExtension</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-202"></a><a name="takeExtension"><a href="System.EasyFile.FilePath.html#takeExtension"><span class="hs-identifier">takeExtension</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier hs-var">splitExtension</span></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-comment">-- | Set the extension of a file, overwriting one if already present.</span><span>
</span><a name="line-205"></a><span class="hs-comment">--</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- &gt; replaceExtension &quot;file.txt&quot; &quot;.bob&quot; == &quot;file.bob&quot;</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- &gt; replaceExtension &quot;file.txt&quot; &quot;bob&quot; == &quot;file.bob&quot;</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- &gt; replaceExtension &quot;file&quot; &quot;.bob&quot; == &quot;file.bob&quot;</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- &gt; replaceExtension &quot;file.txt&quot; &quot;&quot; == &quot;file&quot;</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- &gt; replaceExtension &quot;file.fred.bob&quot; &quot;txt&quot; == &quot;file.fred.txt&quot;</span><span>
</span><a name="line-211"></a><span class="hs-identifier">replaceExtension</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-212"></a><a name="replaceExtension"><a href="System.EasyFile.FilePath.html#replaceExtension"><span class="hs-identifier">replaceExtension</span></a></a><span> </span><a name="local-6989586621679031471"><a href="#local-6989586621679031471"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031472"><a href="#local-6989586621679031472"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier hs-var">dropExtension</span></a><span> </span><a href="#local-6989586621679031471"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="#local-6989586621679031472"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">-- | Alias to 'addExtension', for people who like that sort of thing.</span><span>
</span><a name="line-215"></a><span class="hs-special">(</span><span class="hs-operator">&lt;.&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-216"></a><span class="hs-special">(</span><a name="%3C.%3E"><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator">&lt;.&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#addExtension"><span class="hs-identifier hs-var">addExtension</span></a><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">-- | Remove last extension, and the \&quot;.\&quot; preceding it.</span><span>
</span><a name="line-219"></a><span class="hs-comment">--</span><span>
</span><a name="line-220"></a><span class="hs-comment">-- &gt; dropExtension x == fst (splitExtension x)</span><span>
</span><a name="line-221"></a><span class="hs-identifier">dropExtension</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-222"></a><a name="dropExtension"><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier">dropExtension</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier hs-var">splitExtension</span></a><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-comment">-- | Add an extension, even if there is already one there.</span><span>
</span><a name="line-225"></a><span class="hs-comment">--   E.g. @addExtension \&quot;foo.txt\&quot; \&quot;bat\&quot; -&gt; \&quot;foo.txt.bat\&quot;@.</span><span>
</span><a name="line-226"></a><span class="hs-comment">--</span><span>
</span><a name="line-227"></a><span class="hs-comment">-- &gt; addExtension &quot;file.txt&quot; &quot;bib&quot; == &quot;file.txt.bib&quot;</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- &gt; addExtension &quot;file.&quot; &quot;.bib&quot; == &quot;file..bib&quot;</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- &gt; addExtension &quot;file&quot; &quot;.bib&quot; == &quot;file.bib&quot;</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- &gt; addExtension &quot;/&quot; &quot;x&quot; == &quot;/.x&quot;</span><span>
</span><a name="line-231"></a><span class="hs-comment">-- &gt; Valid x =&gt; takeFileName (addExtension (addTrailingPathSeparator x) &quot;ext&quot;) == &quot;.ext&quot;</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- &gt; Windows: addExtension &quot;\\\\share&quot; &quot;.txt&quot; == &quot;\\\\share\\.txt&quot;</span><span>
</span><a name="line-233"></a><span class="hs-identifier">addExtension</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-234"></a><a name="addExtension"><a href="System.EasyFile.FilePath.html#addExtension"><span class="hs-identifier">addExtension</span></a></a><span> </span><a name="local-6989586621679031473"><a href="#local-6989586621679031473"><span class="hs-identifier">file</span></a></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031473"><span class="hs-identifier hs-var">file</span></a><span>
</span><a name="line-235"></a><span class="hs-identifier">addExtension</span><span> </span><a name="local-6989586621679031474"><a href="#local-6989586621679031474"><span class="hs-identifier">file</span></a></a><span> </span><a name="local-6989586621679031475"><a href="#local-6989586621679031475"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679031476"><a href="#local-6989586621679031476"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-var">joinDrive</span></a><span> </span><a href="#local-6989586621679031478"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679031477"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-236"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-237"></a><span>        </span><a name="local-6989586621679031477"><a href="#local-6989586621679031477"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a><span> </span><a href="#local-6989586621679031476"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679031479"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031475"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-238"></a><span>              </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031479"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier hs-var">extSeparator</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031475"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031478"><a href="#local-6989586621679031478"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031479"><a href="#local-6989586621679031479"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a><span> </span><a href="#local-6989586621679031474"><span class="hs-identifier hs-var">file</span></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">-- | Does the given filename have an extension?</span><span>
</span><a name="line-243"></a><span class="hs-comment">--</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- &gt; null (takeExtension x) == not (hasExtension x)</span><span>
</span><a name="line-245"></a><span class="hs-identifier">hasExtension</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-246"></a><a name="hasExtension"><a href="System.EasyFile.FilePath.html#hasExtension"><span class="hs-identifier">hasExtension</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- | Split on all extensions</span><span>
</span><a name="line-250"></a><span class="hs-comment">--</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- &gt; splitExtensions &quot;file.tar.gz&quot; == (&quot;file&quot;,&quot;.tar.gz&quot;)</span><span>
</span><a name="line-252"></a><span class="hs-identifier">splitExtensions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><a name="splitExtensions"><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier">splitExtensions</span></a></a><span> </span><a name="local-6989586621679031480"><a href="#local-6989586621679031480"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031481"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031483"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031484"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-255"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031481"><a href="#local-6989586621679031481"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031482"><a href="#local-6989586621679031482"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a><span> </span><a href="#local-6989586621679031480"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-256"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031483"><a href="#local-6989586621679031483"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031484"><a href="#local-6989586621679031484"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a><span> </span><a href="#local-6989586621679031482"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">-- | Drop all extensions</span><span>
</span><a name="line-259"></a><span class="hs-comment">--</span><span>
</span><a name="line-260"></a><span class="hs-comment">-- &gt; not $ hasExtension (dropExtensions x)</span><span>
</span><a name="line-261"></a><span class="hs-identifier">dropExtensions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-262"></a><a name="dropExtensions"><a href="System.EasyFile.FilePath.html#dropExtensions"><span class="hs-identifier">dropExtensions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier hs-var">splitExtensions</span></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">-- | Get all extensions</span><span>
</span><a name="line-265"></a><span class="hs-comment">--</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- &gt; takeExtensions &quot;file.tar.gz&quot; == &quot;.tar.gz&quot;</span><span>
</span><a name="line-267"></a><span class="hs-identifier">takeExtensions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-268"></a><a name="takeExtensions"><a href="System.EasyFile.FilePath.html#takeExtensions"><span class="hs-identifier">takeExtensions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier hs-var">splitExtensions</span></a><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- Drive methods</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">-- | Is the given character a valid drive letter?</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- only a-z and A-Z are letters, not isAlpha which is more unicodey</span><span>
</span><a name="line-277"></a><span class="hs-identifier">isLetter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-278"></a><a name="isLetter"><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier">isLetter</span></a></a><span> </span><a name="local-6989586621679031485"><a href="#local-6989586621679031485"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031485"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-char">'a'</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679031485"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-char">'z'</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031485"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-char">'A'</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679031485"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-char">'Z'</span><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span class="hs-comment">-- | Split a path into a drive and a path.</span><span>
</span><a name="line-282"></a><span class="hs-comment">--   On Unix, \/ is a Drive.</span><span>
</span><a name="line-283"></a><span class="hs-comment">--</span><span>
</span><a name="line-284"></a><span class="hs-comment">-- &gt; uncurry (++) (splitDrive x) == x</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- &gt; Windows: splitDrive &quot;file&quot; == (&quot;&quot;,&quot;file&quot;)</span><span>
</span><a name="line-286"></a><span class="hs-comment">-- &gt; Windows: splitDrive &quot;c:/file&quot; == (&quot;c:/&quot;,&quot;file&quot;)</span><span>
</span><a name="line-287"></a><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\shared\\test&quot; == (&quot;\\\\shared\\&quot;,&quot;test&quot;)</span><span>
</span><a name="line-288"></a><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\shared&quot; == (&quot;\\\\shared&quot;,&quot;&quot;)</span><span>
</span><a name="line-289"></a><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\?\\UNC\\shared\\file&quot; == (&quot;\\\\?\\UNC\\shared\\&quot;,&quot;file&quot;)</span><span>
</span><a name="line-290"></a><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\?\\UNCshared\\file&quot; == (&quot;\\\\?\\&quot;,&quot;UNCshared\\file&quot;)</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\?\\d:\\file&quot; == (&quot;\\\\?\\d:\\&quot;,&quot;file&quot;)</span><span>
</span><a name="line-292"></a><span class="hs-comment">-- &gt; Windows: splitDrive &quot;/d&quot; == (&quot;&quot;,&quot;/d&quot;) -- xxx</span><span>
</span><a name="line-293"></a><span class="hs-comment">-- &gt; Posix:   splitDrive &quot;/test&quot; == (&quot;/&quot;,&quot;test&quot;) -- xxx</span><span>
</span><a name="line-294"></a><span class="hs-comment">-- &gt; Posix:   splitDrive &quot;//test&quot; == (&quot;//&quot;,&quot;test&quot;)</span><span>
</span><a name="line-295"></a><span class="hs-comment">-- &gt; Posix:   splitDrive &quot;test/file&quot; == (&quot;&quot;,&quot;test/file&quot;)</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- &gt; Posix:   splitDrive &quot;file&quot; == (&quot;&quot;,&quot;file&quot;)</span><span>
</span><a name="line-297"></a><span class="hs-identifier">splitDrive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span>
</span><a name="line-298"></a><a name="splitDrive"><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier">splitDrive</span></a></a><span> </span><a name="local-6989586621679031486"><a href="#local-6989586621679031486"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier hs-var">isPosix</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'/'</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031486"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-identifier">splitDrive</span><span> </span><a name="local-6989586621679031487"><a href="#local-6989586621679031487"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679031488"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679031488"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-301"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679031488"><a href="#local-6989586621679031488"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a><span> </span><a href="#local-6989586621679031487"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-identifier">splitDrive</span><span> </span><a name="local-6989586621679031489"><a href="#local-6989586621679031489"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679031490"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679031490"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-304"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679031490"><a href="#local-6989586621679031490"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#readDriveUNC"><span class="hs-identifier hs-var">readDriveUNC</span></a><span> </span><a href="#local-6989586621679031489"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-identifier">splitDrive</span><span> </span><a name="local-6989586621679031491"><a href="#local-6989586621679031491"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679031492"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679031492"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-307"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679031492"><a href="#local-6989586621679031492"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#readDriveShare"><span class="hs-identifier hs-var">readDriveShare</span></a><span> </span><a href="#local-6989586621679031491"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-identifier">splitDrive</span><span> </span><a name="local-6989586621679031493"><a href="#local-6989586621679031493"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><a href="#local-6989586621679031493"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-identifier">addSlash</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span>
</span><a name="line-312"></a><a name="addSlash"><a href="System.EasyFile.FilePath.html#addSlash"><span class="hs-identifier">addSlash</span></a></a><span> </span><a name="local-6989586621679031494"><a href="#local-6989586621679031494"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679031495"><a href="#local-6989586621679031495"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031494"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621679031496"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679031497"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-313"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031496"><a href="#local-6989586621679031496"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031497"><a href="#local-6989586621679031497"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031495"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-comment">-- http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/naming_a_file.asp</span><span>
</span><a name="line-316"></a><span class="hs-comment">-- &quot;\\?\D:\&lt;path&gt;&quot; or &quot;\\?\UNC\&lt;server&gt;\&lt;share&gt;&quot;</span><span>
</span><a name="line-317"></a><span class="hs-comment">-- a is &quot;\\?\&quot;</span><span>
</span><a name="line-318"></a><span class="hs-identifier">readDriveUNC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span>
</span><a name="line-319"></a><a name="readDriveUNC"><a href="System.EasyFile.FilePath.html#readDriveUNC"><span class="hs-identifier">readDriveUNC</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031498"><a href="#local-6989586621679031498"><span class="hs-identifier">s1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031499"><a href="#local-6989586621679031499"><span class="hs-identifier">s2</span></a></a><span class="hs-glyph">:</span><span class="hs-char">'?'</span><span class="hs-glyph">:</span><a name="local-6989586621679031500"><a href="#local-6989586621679031500"><span class="hs-identifier">s3</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031501"><a href="#local-6989586621679031501"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031498"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">,</span><a href="#local-6989586621679031499"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">,</span><a href="#local-6989586621679031500"><span class="hs-identifier hs-var">s3</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-320"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">toUpper</span><span> </span><a href="#local-6989586621679031501"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-321"></a><span>        </span><span class="hs-special">(</span><span class="hs-char">'U'</span><span class="hs-glyph">:</span><span class="hs-char">'N'</span><span class="hs-glyph">:</span><span class="hs-char">'C'</span><span class="hs-glyph">:</span><a name="local-6989586621679031840"><a href="#local-6989586621679031840"><span class="hs-identifier">s4</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031840"><span class="hs-identifier hs-var">s4</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-322"></a><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031841"><a href="#local-6989586621679031841"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031842"><a href="#local-6989586621679031842"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#readDriveShareName"><span class="hs-identifier hs-var">readDriveShareName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">4</span><span> </span><a href="#local-6989586621679031501"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-323"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031498"><span class="hs-identifier hs-var">s1</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679031499"><span class="hs-identifier hs-var">s2</span></a><span class="hs-glyph">:</span><span class="hs-char">'?'</span><span class="hs-glyph">:</span><a href="#local-6989586621679031500"><span class="hs-identifier hs-var">s3</span></a><span class="hs-glyph">:</span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">4</span><span> </span><a href="#local-6989586621679031501"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031841"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031842"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a><span> </span><a href="#local-6989586621679031501"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-325"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031843"><a href="#local-6989586621679031843"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031844"><a href="#local-6989586621679031844"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031498"><span class="hs-identifier hs-var">s1</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679031499"><span class="hs-identifier hs-var">s2</span></a><span class="hs-glyph">:</span><span class="hs-char">'?'</span><span class="hs-glyph">:</span><a href="#local-6989586621679031500"><span class="hs-identifier hs-var">s3</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679031843"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679031844"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-326"></a><span>                 </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-327"></a><span class="hs-identifier">readDriveUNC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-comment">{- c:\ -}</span><span>
</span><a name="line-330"></a><span class="hs-identifier">readDriveLetter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span>
</span><a name="line-331"></a><a name="readDriveLetter"><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier">readDriveLetter</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031845"><a href="#local-6989586621679031845"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-char">':'</span><span class="hs-glyph">:</span><a name="local-6989586621679031846"><a href="#local-6989586621679031846"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031847"><a href="#local-6989586621679031847"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier hs-var">isLetter</span></a><span> </span><a href="#local-6989586621679031845"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031846"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.EasyFile.FilePath.html#addSlash"><span class="hs-identifier hs-var">addSlash</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031845"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-char">':'</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031846"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679031847"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span class="hs-identifier">readDriveLetter</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031848"><a href="#local-6989586621679031848"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-char">':'</span><span class="hs-glyph">:</span><a name="local-6989586621679031849"><a href="#local-6989586621679031849"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier hs-var">isLetter</span></a><span> </span><a href="#local-6989586621679031848"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679031848"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-char">':'</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031849"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span class="hs-identifier">readDriveLetter</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">{- \\sharename\ -}</span><span>
</span><a name="line-336"></a><span class="hs-identifier">readDriveShare</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span>
</span><a name="line-337"></a><a name="readDriveShare"><a href="System.EasyFile.FilePath.html#readDriveShare"><span class="hs-identifier">readDriveShare</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031850"><a href="#local-6989586621679031850"><span class="hs-identifier">s1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031851"><a href="#local-6989586621679031851"><span class="hs-identifier">s2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031852"><a href="#local-6989586621679031852"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031850"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031851"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-338"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031850"><span class="hs-identifier hs-var">s1</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679031851"><span class="hs-identifier hs-var">s2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679031853"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679031854"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-339"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031853"><a href="#local-6989586621679031853"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031854"><a href="#local-6989586621679031854"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#readDriveShareName"><span class="hs-identifier hs-var">readDriveShareName</span></a><span> </span><a href="#local-6989586621679031852"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-340"></a><span class="hs-identifier">readDriveShare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">{- assume you have already seen \\ -}</span><span>
</span><a name="line-343"></a><span class="hs-comment">{- share\bob -&gt; &quot;share&quot;,&quot;\&quot;,&quot;bob&quot; -}</span><span>
</span><a name="line-344"></a><span class="hs-identifier">readDriveShareName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">)</span><span>
</span><a name="line-345"></a><a name="readDriveShareName"><a href="System.EasyFile.FilePath.html#readDriveShareName"><span class="hs-identifier">readDriveShareName</span></a></a><span> </span><a name="local-6989586621679031855"><a href="#local-6989586621679031855"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#addSlash"><span class="hs-identifier hs-var">addSlash</span></a><span> </span><a href="#local-6989586621679031856"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679031857"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-346"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031856"><a href="#local-6989586621679031856"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031857"><a href="#local-6989586621679031857"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031855"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-comment">-- | Join a drive and the rest of the path.</span><span>
</span><a name="line-351"></a><span class="hs-comment">--</span><span>
</span><a name="line-352"></a><span class="hs-comment">-- &gt;          uncurry joinDrive (splitDrive x) == x</span><span>
</span><a name="line-353"></a><span class="hs-comment">-- &gt; Windows: joinDrive &quot;C:&quot; &quot;foo&quot; == &quot;C:foo&quot;</span><span>
</span><a name="line-354"></a><span class="hs-comment">-- &gt; Windows: joinDrive &quot;C:/&quot; &quot;bar&quot; == &quot;C:/bar&quot;</span><span>
</span><a name="line-355"></a><span class="hs-comment">-- &gt; Windows: joinDrive &quot;\\\\share&quot; &quot;foo&quot; == &quot;\\\\share/foo&quot; -- xxx</span><span>
</span><a name="line-356"></a><span class="hs-comment">-- &gt; Windows: joinDrive &quot;/:&quot; &quot;foo&quot; == &quot;/:/foo&quot; -- xxx</span><span>
</span><a name="line-357"></a><span class="hs-identifier">joinDrive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-358"></a><a name="joinDrive"><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier">joinDrive</span></a></a><span> </span><a name="local-6989586621679031858"><a href="#local-6989586621679031858"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679031859"><a href="#local-6989586621679031859"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier hs-var">isPosix</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031858"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031859"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-359"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031858"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031859"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-360"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031859"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031858"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-361"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679031858"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031858"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031859"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-362"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031858"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-363"></a><span>                                </span><span class="hs-special">[</span><a name="local-6989586621679031860"><a href="#local-6989586621679031860"><span class="hs-identifier">a1</span></a></a><span class="hs-special">,</span><span class="hs-char">':'</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier hs-var">isLetter</span></a><span> </span><a href="#local-6989586621679031860"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679031858"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031859"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-364"></a><span>                                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679031858"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031859"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | Get the drive from a filepath.</span><span>
</span><a name="line-367"></a><span class="hs-comment">--</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- &gt; takeDrive x == fst (splitDrive x)</span><span>
</span><a name="line-369"></a><span class="hs-identifier">takeDrive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-370"></a><a name="takeDrive"><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier">takeDrive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-comment">-- | Delete the drive, if it exists.</span><span>
</span><a name="line-373"></a><span class="hs-comment">--</span><span>
</span><a name="line-374"></a><span class="hs-comment">-- &gt; dropDrive x == snd (splitDrive x)</span><span>
</span><a name="line-375"></a><span class="hs-identifier">dropDrive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-376"></a><a name="dropDrive"><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier">dropDrive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a><span>
</span><a name="line-377"></a><span>
</span><a name="line-378"></a><span class="hs-comment">-- | Does a path have a drive.</span><span>
</span><a name="line-379"></a><span class="hs-comment">--</span><span>
</span><a name="line-380"></a><span class="hs-comment">-- &gt; not (hasDrive x) == null (takeDrive x)</span><span>
</span><a name="line-381"></a><span class="hs-identifier">hasDrive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-382"></a><a name="hasDrive"><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier">hasDrive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-var">takeDrive</span></a><span>
</span><a name="line-383"></a><span>
</span><a name="line-384"></a><span>
</span><a name="line-385"></a><span class="hs-comment">-- | Is an element a drive</span><span>
</span><a name="line-386"></a><span class="hs-identifier">isDrive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-387"></a><a name="isDrive"><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier">isDrive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier hs-var">dropDrive</span></a><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><a name="line-391"></a><span class="hs-comment">-- Operations on a filepath, as a list of directories</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-comment">-- | Split a filename into directory and file. 'combine' is the inverse.</span><span>
</span><a name="line-394"></a><span class="hs-comment">--</span><span>
</span><a name="line-395"></a><span class="hs-comment">-- &gt; uncurry (++) (splitFileName x) == x</span><span>
</span><a name="line-396"></a><span class="hs-comment">-- &gt; Valid x =&gt; uncurry combine (splitFileName x) == x</span><span>
</span><a name="line-397"></a><span class="hs-comment">-- &gt; splitFileName &quot;file/bob.txt&quot; == (&quot;file/&quot;, &quot;bob.txt&quot;)</span><span>
</span><a name="line-398"></a><span class="hs-comment">-- &gt; splitFileName &quot;file/&quot; == (&quot;file/&quot;, &quot;&quot;)</span><span>
</span><a name="line-399"></a><span class="hs-comment">-- &gt; splitFileName &quot;bob&quot; == (&quot;&quot;, &quot;bob&quot;)</span><span>
</span><a name="line-400"></a><span class="hs-comment">-- &gt; Posix:   splitFileName &quot;/&quot; == (&quot;/&quot;,&quot;&quot;)</span><span>
</span><a name="line-401"></a><span class="hs-comment">-- &gt; Windows: splitFileName &quot;c:&quot; == (&quot;c:&quot;,&quot;&quot;)</span><span>
</span><a name="line-402"></a><span class="hs-identifier">splitFileName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-403"></a><a name="splitFileName"><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier">splitFileName</span></a></a><span> </span><a name="local-6989586621679031861"><a href="#local-6989586621679031861"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031864"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031863"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031862"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-405"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031862"><a href="#local-6989586621679031862"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031863"><a href="#local-6989586621679031863"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031865"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-406"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031864"><a href="#local-6989586621679031864"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031865"><a href="#local-6989586621679031865"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a><span> </span><a href="#local-6989586621679031861"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-comment">-- | Set the filename.</span><span>
</span><a name="line-410"></a><span class="hs-comment">--</span><span>
</span><a name="line-411"></a><span class="hs-comment">-- &gt; Valid x =&gt; replaceFileName x (takeFileName x) == x</span><span>
</span><a name="line-412"></a><span class="hs-identifier">replaceFileName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-413"></a><a name="replaceFileName"><a href="System.EasyFile.FilePath.html#replaceFileName"><span class="hs-identifier">replaceFileName</span></a></a><span> </span><a name="local-6989586621679031866"><a href="#local-6989586621679031866"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031867"><a href="#local-6989586621679031867"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier hs-var">dropFileName</span></a><span> </span><a href="#local-6989586621679031866"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span> </span><a href="#local-6989586621679031867"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-comment">-- | Drop the filename.</span><span>
</span><a name="line-416"></a><span class="hs-comment">--</span><span>
</span><a name="line-417"></a><span class="hs-comment">-- &gt; dropFileName x == fst (splitFileName x)</span><span>
</span><a name="line-418"></a><span class="hs-identifier">dropFileName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-419"></a><a name="dropFileName"><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier">dropFileName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><span class="hs-comment">-- | Get the file name.</span><span>
</span><a name="line-423"></a><span class="hs-comment">--</span><span>
</span><a name="line-424"></a><span class="hs-comment">-- &gt; takeFileName &quot;test/&quot; == &quot;&quot;</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- &gt; takeFileName x `isSuffixOf` x</span><span>
</span><a name="line-426"></a><span class="hs-comment">-- &gt; takeFileName x == snd (splitFileName x)</span><span>
</span><a name="line-427"></a><span class="hs-comment">-- &gt; Valid x =&gt; takeFileName (replaceFileName x &quot;fred&quot;) == &quot;fred&quot;</span><span>
</span><a name="line-428"></a><span class="hs-comment">-- &gt; Valid x =&gt; takeFileName (x &lt;/&gt; &quot;fred&quot;) == &quot;fred&quot;</span><span>
</span><a name="line-429"></a><span class="hs-comment">-- &gt; Valid x =&gt; isRelative (takeFileName x)</span><span>
</span><a name="line-430"></a><span class="hs-identifier">takeFileName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-431"></a><a name="takeFileName"><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier">takeFileName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span class="hs-comment">-- | Get the base name, without an extension or path.</span><span>
</span><a name="line-434"></a><span class="hs-comment">--</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- &gt; takeBaseName &quot;file/test.txt&quot; == &quot;test&quot;</span><span>
</span><a name="line-436"></a><span class="hs-comment">-- &gt; takeBaseName &quot;dave.ext&quot; == &quot;dave&quot;</span><span>
</span><a name="line-437"></a><span class="hs-comment">-- &gt; takeBaseName &quot;&quot; == &quot;&quot;</span><span>
</span><a name="line-438"></a><span class="hs-comment">-- &gt; takeBaseName &quot;test&quot; == &quot;test&quot;</span><span>
</span><a name="line-439"></a><span class="hs-comment">-- &gt; takeBaseName (addTrailingPathSeparator x) == &quot;&quot;</span><span>
</span><a name="line-440"></a><span class="hs-comment">-- &gt; takeBaseName &quot;file/file.tar.gz&quot; == &quot;file.tar&quot;</span><span>
</span><a name="line-441"></a><span class="hs-identifier">takeBaseName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-442"></a><a name="takeBaseName"><a href="System.EasyFile.FilePath.html#takeBaseName"><span class="hs-identifier">takeBaseName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier hs-var">dropExtension</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-comment">-- | Set the base name.</span><span>
</span><a name="line-445"></a><span class="hs-comment">--</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- &gt; replaceBaseName &quot;file/test.txt&quot; &quot;bob&quot; == &quot;file/bob.txt&quot;</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- &gt; replaceBaseName &quot;fred&quot; &quot;bill&quot; == &quot;bill&quot;</span><span>
</span><a name="line-448"></a><span class="hs-comment">-- &gt; replaceBaseName &quot;/dave/fred/bob.gz.tar&quot; &quot;new&quot; == &quot;/dave/fred/new.tar&quot;</span><span>
</span><a name="line-449"></a><span class="hs-comment">-- &gt; replaceBaseName x (takeBaseName x) == x</span><span>
</span><a name="line-450"></a><span class="hs-identifier">replaceBaseName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-451"></a><a name="replaceBaseName"><a href="System.EasyFile.FilePath.html#replaceBaseName"><span class="hs-identifier">replaceBaseName</span></a></a><span> </span><a name="local-6989586621679031868"><a href="#local-6989586621679031868"><span class="hs-identifier">pth</span></a></a><span> </span><a name="local-6989586621679031869"><a href="#local-6989586621679031869"><span class="hs-identifier">nam</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier hs-var">combineAlways</span></a><span> </span><a href="#local-6989586621679031870"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031869"><span class="hs-identifier hs-var">nam</span></a><span> </span><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="#local-6989586621679031872"><span class="hs-identifier hs-var">ext</span></a><span class="hs-special">)</span><span>
</span><a name="line-452"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-453"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031870"><a href="#local-6989586621679031870"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031871"><a href="#local-6989586621679031871"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a><span> </span><a href="#local-6989586621679031868"><span class="hs-identifier hs-var">pth</span></a><span>
</span><a name="line-454"></a><span>        </span><a name="local-6989586621679031872"><a href="#local-6989586621679031872"><span class="hs-identifier">ext</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#takeExtension"><span class="hs-identifier hs-var">takeExtension</span></a><span> </span><a href="#local-6989586621679031871"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span class="hs-comment">-- | Is an item either a directory or the last character a path separator?</span><span>
</span><a name="line-457"></a><span class="hs-comment">--</span><span>
</span><a name="line-458"></a><span class="hs-comment">-- &gt; hasTrailingPathSeparator &quot;test&quot; == False</span><span>
</span><a name="line-459"></a><span class="hs-comment">-- &gt; hasTrailingPathSeparator &quot;test/&quot; == True</span><span>
</span><a name="line-460"></a><span class="hs-identifier">hasTrailingPathSeparator</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-461"></a><a name="hasTrailingPathSeparator"><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier">hasTrailingPathSeparator</span></a></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-462"></a><span class="hs-identifier">hasTrailingPathSeparator</span><span> </span><a name="local-6989586621679031873"><a href="#local-6989586621679031873"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679031873"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span class="hs-comment">-- | Add a trailing file path separator if one is not already present.</span><span>
</span><a name="line-466"></a><span class="hs-comment">--</span><span>
</span><a name="line-467"></a><span class="hs-comment">-- &gt; hasTrailingPathSeparator (addTrailingPathSeparator x)</span><span>
</span><a name="line-468"></a><span class="hs-comment">-- &gt; hasTrailingPathSeparator x ==&gt; addTrailingPathSeparator x == x</span><span>
</span><a name="line-469"></a><span class="hs-comment">-- &gt; addTrailingPathSeparator &quot;test/rest&quot; == &quot;test/rest/&quot;</span><span>
</span><a name="line-470"></a><span class="hs-identifier">addTrailingPathSeparator</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-471"></a><a name="addTrailingPathSeparator"><a href="System.EasyFile.FilePath.html#addTrailingPathSeparator"><span class="hs-identifier">addTrailingPathSeparator</span></a></a><span> </span><a name="local-6989586621679031874"><a href="#local-6989586621679031874"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier hs-var">hasTrailingPathSeparator</span></a><span> </span><a href="#local-6989586621679031874"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679031874"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031874"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span class="hs-special">]</span><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-comment">-- | Remove any trailing path separators</span><span>
</span><a name="line-475"></a><span class="hs-comment">--</span><span>
</span><a name="line-476"></a><span class="hs-comment">-- &gt; dropTrailingPathSeparator &quot;file/test/&quot; == &quot;file/test&quot;</span><span>
</span><a name="line-477"></a><span class="hs-comment">-- &gt; not (hasTrailingPathSeparator (dropTrailingPathSeparator x)) || isDrive x</span><span>
</span><a name="line-478"></a><span class="hs-comment">-- &gt; dropTrailingPathSeparator &quot;/&quot; == &quot;/&quot;</span><span>
</span><a name="line-479"></a><span class="hs-identifier">dropTrailingPathSeparator</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-480"></a><a name="dropTrailingPathSeparator"><a href="System.EasyFile.FilePath.html#dropTrailingPathSeparator"><span class="hs-identifier">dropTrailingPathSeparator</span></a></a><span> </span><a name="local-6989586621679031875"><a href="#local-6989586621679031875"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-481"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier hs-var">hasTrailingPathSeparator</span></a><span> </span><a href="#local-6989586621679031875"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-var">isDrive</span></a><span> </span><a href="#local-6989586621679031875"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679031876"><a href="#local-6989586621679031876"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031875"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-483"></a><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031876"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031876"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-484"></a><span>    </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031875"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span>
</span><a name="line-487"></a><span class="hs-comment">-- | Get the directory name, move up one level.</span><span>
</span><a name="line-488"></a><span class="hs-comment">--</span><span>
</span><a name="line-489"></a><span class="hs-comment">-- &gt;           takeDirectory x `isPrefixOf` x</span><span>
</span><a name="line-490"></a><span class="hs-comment">-- &gt;           takeDirectory &quot;foo&quot; == &quot;&quot;</span><span>
</span><a name="line-491"></a><span class="hs-comment">-- &gt;           takeDirectory &quot;/foo/bar/baz&quot; == &quot;/foo/bar&quot;</span><span>
</span><a name="line-492"></a><span class="hs-comment">-- &gt;           takeDirectory &quot;/foo/bar/baz/&quot; == &quot;/foo/bar/baz&quot;</span><span>
</span><a name="line-493"></a><span class="hs-comment">-- &gt;           takeDirectory &quot;foo/bar/baz&quot; == &quot;foo/bar&quot;</span><span>
</span><a name="line-494"></a><span class="hs-comment">-- &gt; Windows:  takeDirectory &quot;foo\\bar\\\\&quot; == &quot;foo\\bar&quot; -- xxx</span><span>
</span><a name="line-495"></a><span class="hs-comment">-- &gt; Windows:  takeDirectory &quot;C:/&quot; == &quot;C:/&quot;</span><span>
</span><a name="line-496"></a><span class="hs-identifier">takeDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-497"></a><a name="takeDirectory"><a href="System.EasyFile.FilePath.html#takeDirectory"><span class="hs-identifier">takeDirectory</span></a></a><span> </span><a name="local-6989586621679031877"><a href="#local-6989586621679031877"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-var">isDrive</span></a><span> </span><a href="#local-6989586621679031879"><span class="hs-identifier hs-var">file</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679031879"><span class="hs-identifier hs-var">file</span></a><span>
</span><a name="line-498"></a><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031878"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031879"><span class="hs-identifier hs-var">file</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679031879"><span class="hs-identifier hs-var">file</span></a><span>
</span><a name="line-499"></a><span>                  </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031878"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-500"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-501"></a><span>        </span><a name="local-6989586621679031878"><a href="#local-6989586621679031878"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031879"><span class="hs-identifier hs-var">file</span></a><span>
</span><a name="line-502"></a><span>        </span><a name="local-6989586621679031879"><a href="#local-6989586621679031879"><span class="hs-identifier">file</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier hs-var">dropFileName</span></a><span> </span><a href="#local-6989586621679031877"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><span class="hs-comment">-- | Set the directory, keeping the filename the same.</span><span>
</span><a name="line-505"></a><span class="hs-comment">--</span><span>
</span><a name="line-506"></a><span class="hs-comment">-- &gt; replaceDirectory x (takeDirectory x) `equalFilePath` x</span><span>
</span><a name="line-507"></a><span class="hs-identifier">replaceDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-508"></a><a name="replaceDirectory"><a href="System.EasyFile.FilePath.html#replaceDirectory"><span class="hs-identifier">replaceDirectory</span></a></a><span> </span><a name="local-6989586621679031880"><a href="#local-6989586621679031880"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031881"><a href="#local-6989586621679031881"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier hs-var">combineAlways</span></a><span> </span><a href="#local-6989586621679031881"><span class="hs-identifier hs-var">dir</span></a><span> </span><span class="hs-special">(</span><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a><span> </span><a href="#local-6989586621679031880"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span>
</span><a name="line-511"></a><span class="hs-comment">-- | Combine two paths, if the second path 'isAbsolute', then it returns the second.</span><span>
</span><a name="line-512"></a><span class="hs-comment">--</span><span>
</span><a name="line-513"></a><span class="hs-comment">-- &gt; Valid x =&gt; combine (takeDirectory x) (takeFileName x) `equalFilePath` x</span><span>
</span><a name="line-514"></a><span class="hs-comment">-- &gt; combine &quot;/&quot; &quot;test&quot; == &quot;/test&quot;</span><span>
</span><a name="line-515"></a><span class="hs-comment">-- &gt; combine &quot;home&quot; &quot;bob&quot; == &quot;home/bob&quot;</span><span>
</span><a name="line-516"></a><span class="hs-identifier">combine</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-517"></a><a name="combine"><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier">combine</span></a></a><span> </span><a name="local-6989586621679031882"><a href="#local-6989586621679031882"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679031883"><a href="#local-6989586621679031883"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier hs-var">hasDrive</span></a><span> </span><a href="#local-6989586621679031883"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031883"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679031883"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031883"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-518"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier hs-var">combineAlways</span></a><span> </span><a href="#local-6989586621679031882"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679031883"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-comment">-- | Combine two paths, assuming rhs is NOT absolute.</span><span>
</span><a name="line-521"></a><span class="hs-identifier">combineAlways</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-522"></a><a name="combineAlways"><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier">combineAlways</span></a></a><span> </span><a name="local-6989586621679031884"><a href="#local-6989586621679031884"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679031885"><a href="#local-6989586621679031885"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031884"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031885"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-523"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031885"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031884"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-524"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679031884"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031884"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031885"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-525"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-var">isDrive</span></a><span> </span><a href="#local-6989586621679031884"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-var">joinDrive</span></a><span> </span><a href="#local-6989586621679031884"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679031885"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-526"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031884"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031885"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span>
</span><a name="line-529"></a><span class="hs-comment">-- | A nice alias for 'combine'.</span><span>
</span><a name="line-530"></a><span class="hs-special">(</span><span class="hs-operator">&lt;/&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-531"></a><span class="hs-special">(</span><a name="%3C%2F%3E"><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator">&lt;/&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier hs-var">combine</span></a><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span>
</span><a name="line-534"></a><span class="hs-comment">-- | Split a path by the directory separator.</span><span>
</span><a name="line-535"></a><span class="hs-comment">--</span><span>
</span><a name="line-536"></a><span class="hs-comment">-- &gt; concat (splitPath x) == x</span><span>
</span><a name="line-537"></a><span class="hs-comment">-- &gt; splitPath &quot;test//item/&quot; == [&quot;test//&quot;,&quot;item/&quot;]</span><span>
</span><a name="line-538"></a><span class="hs-comment">-- &gt; splitPath &quot;test/item/file&quot; == [&quot;test/&quot;,&quot;item/&quot;,&quot;file&quot;]</span><span>
</span><a name="line-539"></a><span class="hs-comment">-- &gt; splitPath &quot;&quot; == []</span><span>
</span><a name="line-540"></a><span class="hs-comment">-- &gt; Windows: splitPath &quot;c:/test/path&quot; == [&quot;c:/&quot;,&quot;test/&quot;,&quot;path&quot;]</span><span>
</span><a name="line-541"></a><span class="hs-comment">-- &gt; Posix:   splitPath &quot;/file/test&quot; == [&quot;/&quot;,&quot;file/&quot;,&quot;test&quot;]</span><span>
</span><a name="line-542"></a><span class="hs-identifier">splitPath</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">]</span><span>
</span><a name="line-543"></a><a name="splitPath"><a href="System.EasyFile.FilePath.html#splitPath"><span class="hs-identifier">splitPath</span></a></a><span> </span><a name="local-6989586621679031886"><a href="#local-6989586621679031886"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031887"><span class="hs-identifier hs-var">drive</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679031887"><span class="hs-identifier hs-var">drive</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679031889"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679031888"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-544"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-545"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031887"><a href="#local-6989586621679031887"><span class="hs-identifier">drive</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031888"><a href="#local-6989586621679031888"><span class="hs-identifier">path</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a><span> </span><a href="#local-6989586621679031886"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span>        </span><a name="local-6989586621679031889"><a href="#local-6989586621679031889"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-548"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679031890"><a href="#local-6989586621679031890"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031891"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621679031893"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679031889"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679031894"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-549"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-550"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679031891"><a href="#local-6989586621679031891"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031892"><a href="#local-6989586621679031892"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031890"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-551"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679031893"><a href="#local-6989586621679031893"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031894"><a href="#local-6989586621679031894"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031892"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-552"></a><span>
</span><a name="line-553"></a><span class="hs-comment">-- | Just as 'splitPath', but don't add the trailing slashes to each element.</span><span>
</span><a name="line-554"></a><span class="hs-comment">--</span><span>
</span><a name="line-555"></a><span class="hs-comment">-- &gt; splitDirectories &quot;test/file&quot; == [&quot;test&quot;,&quot;file&quot;]</span><span>
</span><a name="line-556"></a><span class="hs-comment">-- &gt; splitDirectories &quot;/test/file&quot; == [&quot;/&quot;,&quot;test&quot;,&quot;file&quot;]</span><span>
</span><a name="line-557"></a><span class="hs-comment">-- &gt; Valid x =&gt; joinPath (splitDirectories x) `equalFilePath` x</span><span>
</span><a name="line-558"></a><span class="hs-comment">-- &gt; splitDirectories &quot;&quot; == []</span><span>
</span><a name="line-559"></a><span class="hs-identifier">splitDirectories</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">]</span><span>
</span><a name="line-560"></a><a name="splitDirectories"><a href="System.EasyFile.FilePath.html#splitDirectories"><span class="hs-identifier">splitDirectories</span></a></a><span> </span><a name="local-6989586621679031895"><a href="#local-6989586621679031895"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-561"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier hs-var">hasDrive</span></a><span> </span><a href="#local-6989586621679031895"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679031896"><span class="hs-identifier hs-var">pathComponents</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679031897"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679031896"><span class="hs-identifier hs-var">pathComponents</span></a><span class="hs-special">)</span><span>
</span><a name="line-562"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031897"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679031896"><span class="hs-identifier hs-var">pathComponents</span></a><span>
</span><a name="line-563"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-564"></a><span>        </span><a name="local-6989586621679031896"><a href="#local-6989586621679031896"><span class="hs-identifier">pathComponents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a><span> </span><a href="#local-6989586621679031895"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-565"></a><span>
</span><a name="line-566"></a><span>        </span><a name="local-6989586621679031897"><a href="#local-6989586621679031897"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679031899"><a href="#local-6989586621679031899"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679031898"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679031899"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-567"></a><span>        </span><a name="local-6989586621679031898"><a href="#local-6989586621679031898"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679031900"><a href="#local-6989586621679031900"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031901"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679031900"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031901"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-568"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679031901"><a href="#local-6989586621679031901"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031900"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-comment">-- | Join path elements back together.</span><span>
</span><a name="line-572"></a><span class="hs-comment">--</span><span>
</span><a name="line-573"></a><span class="hs-comment">-- &gt; Valid x =&gt; joinPath (splitPath x) == x</span><span>
</span><a name="line-574"></a><span class="hs-comment">-- &gt; joinPath [] == &quot;&quot;</span><span>
</span><a name="line-575"></a><span class="hs-comment">-- &gt; Posix: joinPath [&quot;test&quot;,&quot;file&quot;,&quot;path&quot;] == &quot;test/file/path&quot;</span><span>
</span><a name="line-576"></a><span>
</span><a name="line-577"></a><span class="hs-comment">-- Note that this definition on c:\\c:\\, join then split will give c:\\.</span><span>
</span><a name="line-578"></a><span class="hs-identifier">joinPath</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-579"></a><a name="joinPath"><a href="System.EasyFile.FilePath.html#joinPath"><span class="hs-identifier">joinPath</span></a></a><span> </span><a name="local-6989586621679031902"><a href="#local-6989586621679031902"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier hs-var">combine</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679031902"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span>
</span><a name="line-584"></a><span>
</span><a name="line-585"></a><span>
</span><a name="line-586"></a><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><a name="line-587"></a><span class="hs-comment">-- File name manipulators</span><span>
</span><a name="line-588"></a><span>
</span><a name="line-589"></a><span class="hs-comment">-- | Equality of two 'FilePath's.</span><span>
</span><a name="line-590"></a><span class="hs-comment">--   If you call @System.Directory.canonicalizePath@</span><span>
</span><a name="line-591"></a><span class="hs-comment">--   first this has a much better chance of working.</span><span>
</span><a name="line-592"></a><span class="hs-comment">--   Note that this doesn't follow symlinks or DOSNAM~1s.</span><span>
</span><a name="line-593"></a><span class="hs-comment">--</span><span>
</span><a name="line-594"></a><span class="hs-comment">-- &gt;          x == y ==&gt; equalFilePath x y</span><span>
</span><a name="line-595"></a><span class="hs-comment">-- &gt;          normalise x == normalise y ==&gt; equalFilePath x y</span><span>
</span><a name="line-596"></a><span class="hs-comment">-- &gt; Posix:   equalFilePath &quot;foo&quot; &quot;foo/&quot;</span><span>
</span><a name="line-597"></a><span class="hs-comment">-- &gt; Posix:   not (equalFilePath &quot;foo&quot; &quot;/foo&quot;)</span><span>
</span><a name="line-598"></a><span class="hs-comment">-- &gt; Posix:   not (equalFilePath &quot;foo&quot; &quot;FOO&quot;)</span><span>
</span><a name="line-599"></a><span class="hs-comment">-- &gt; Windows: equalFilePath &quot;foo&quot; &quot;FOO&quot;</span><span>
</span><a name="line-600"></a><span class="hs-identifier">equalFilePath</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-601"></a><a name="equalFilePath"><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier">equalFilePath</span></a></a><span> </span><a name="local-6989586621679031903"><a href="#local-6989586621679031903"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679031904"><a href="#local-6989586621679031904"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031905"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679031903"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679031905"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679031904"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-602"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-603"></a><span>        </span><a name="local-6989586621679031905"><a href="#local-6989586621679031905"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679031907"><a href="#local-6989586621679031907"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier hs-var">isWindows</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031906"><span class="hs-identifier hs-var">dropTrailSlash</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">toLower</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span> </span><a href="#local-6989586621679031907"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-604"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031906"><span class="hs-identifier hs-var">dropTrailSlash</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span> </span><a href="#local-6989586621679031907"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span>        </span><a name="local-6989586621679031906"><a href="#local-6989586621679031906"><span class="hs-identifier">dropTrailSlash</span></a></a><span> </span><a name="local-6989586621679031908"><a href="#local-6989586621679031908"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679031908"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679031908"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><a href="#local-6989586621679031908"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-607"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031908"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-608"></a><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-comment">-- | Contract a filename, based on a relative path.</span><span>
</span><a name="line-611"></a><span class="hs-comment">--</span><span>
</span><a name="line-612"></a><span class="hs-comment">--   There is no corresponding @makeAbsolute@ function, instead use</span><span>
</span><a name="line-613"></a><span class="hs-comment">--   @System.Directory.canonicalizePath@ which has the same effect.</span><span>
</span><a name="line-614"></a><span class="hs-comment">--</span><span>
</span><a name="line-615"></a><span class="hs-comment">-- &gt;          Valid y =&gt; equalFilePath x y || (isRelative x &amp;&amp; makeRelative y x == x) || equalFilePath (y &lt;/&gt; makeRelative y x) x</span><span>
</span><a name="line-616"></a><span class="hs-comment">-- &gt;          makeRelative x x == &quot;.&quot;</span><span>
</span><a name="line-617"></a><span class="hs-comment">-- &gt;          null y || equalFilePath (makeRelative x (x &lt;/&gt; y)) y || null (takeFileName x)</span><span>
</span><a name="line-618"></a><span class="hs-comment">-- &gt; Windows: makeRelative &quot;C:/Home&quot; &quot;c:/home/bob&quot; == &quot;bob&quot;</span><span>
</span><a name="line-619"></a><span class="hs-comment">-- &gt; Windows: makeRelative &quot;C:/Home&quot; &quot;D:/Home/Bob&quot; == &quot;D:/Home/Bob&quot;</span><span>
</span><a name="line-620"></a><span class="hs-comment">-- &gt; Windows: makeRelative &quot;C:/Home&quot; &quot;C:Home/Bob&quot; == &quot;C:Home/Bob&quot;</span><span>
</span><a name="line-621"></a><span class="hs-comment">-- &gt; Windows: makeRelative &quot;/Home&quot; &quot;/home/bob&quot; == &quot;bob&quot;</span><span>
</span><a name="line-622"></a><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/Home&quot; &quot;/home/bob&quot; == &quot;/home/bob&quot;</span><span>
</span><a name="line-623"></a><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/home/&quot; &quot;/home/bob/foo/bar&quot; == &quot;bob/foo/bar&quot;</span><span>
</span><a name="line-624"></a><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/fred&quot; &quot;bob&quot; == &quot;bob&quot;</span><span>
</span><a name="line-625"></a><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/file/test&quot; &quot;/file/test/fred&quot; == &quot;fred&quot;</span><span>
</span><a name="line-626"></a><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/file/test&quot; &quot;/file/test/fred/&quot; == &quot;fred/&quot;</span><span>
</span><a name="line-627"></a><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;some/path&quot; &quot;some/path/a/b/c&quot; == &quot;a/b/c&quot;</span><span>
</span><a name="line-628"></a><span class="hs-identifier">makeRelative</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-629"></a><a name="makeRelative"><a href="System.EasyFile.FilePath.html#makeRelative"><span class="hs-identifier">makeRelative</span></a></a><span> </span><a name="local-6989586621679031909"><a href="#local-6989586621679031909"><span class="hs-identifier">root</span></a></a><span> </span><a name="local-6989586621679031910"><a href="#local-6989586621679031910"><span class="hs-identifier">path</span></a></a><span>
</span><a name="line-630"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier hs-var">equalFilePath</span></a><span> </span><a href="#local-6989586621679031909"><span class="hs-identifier hs-var">root</span></a><span> </span><a href="#local-6989586621679031910"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-631"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679031914"><span class="hs-identifier hs-var">takeAbs</span></a><span> </span><a href="#local-6989586621679031909"><span class="hs-identifier hs-var">root</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679031914"><span class="hs-identifier hs-var">takeAbs</span></a><span> </span><a href="#local-6989586621679031910"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031910"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-632"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031911"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031913"><span class="hs-identifier hs-var">dropAbs</span></a><span> </span><a href="#local-6989586621679031909"><span class="hs-identifier hs-var">root</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031913"><span class="hs-identifier hs-var">dropAbs</span></a><span> </span><a href="#local-6989586621679031910"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-634"></a><span>        </span><a name="local-6989586621679031911"><a href="#local-6989586621679031911"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a name="local-6989586621679031915"><a href="#local-6989586621679031915"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031915"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-635"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679031916"><a href="#local-6989586621679031916"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031917"><a href="#local-6989586621679031917"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031918"><a href="#local-6989586621679031918"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031919"><a href="#local-6989586621679031919"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031912"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679031916"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-636"></a><span>                    </span><span class="hs-special">(</span><a name="local-6989586621679031920"><a href="#local-6989586621679031920"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031921"><a href="#local-6989586621679031921"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031912"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679031917"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-637"></a><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier hs-var">equalFilePath</span></a><span> </span><a href="#local-6989586621679031918"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679031920"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679031911"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679031919"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679031921"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031910"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span>        </span><a name="local-6989586621679031912"><a href="#local-6989586621679031912"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679031922"><a href="#local-6989586621679031922"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropWhile</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031923"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031924"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-640"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031923"><a href="#local-6989586621679031923"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031924"><a href="#local-6989586621679031924"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031922"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-641"></a><span>
</span><a name="line-642"></a><span>        </span><span class="hs-comment">-- on windows, need to drop '/' which is kind of absolute, but not a drive</span><span>
</span><a name="line-643"></a><span>        </span><a name="local-6989586621679031913"><a href="#local-6989586621679031913"><span class="hs-identifier">dropAbs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031925"><a href="#local-6989586621679031925"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031926"><a href="#local-6989586621679031926"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031925"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031926"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-644"></a><span>        </span><span class="hs-identifier">dropAbs</span><span> </span><a name="local-6989586621679031927"><a href="#local-6989586621679031927"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier hs-var">dropDrive</span></a><span> </span><a href="#local-6989586621679031927"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-645"></a><span>
</span><a name="line-646"></a><span>        </span><a name="local-6989586621679031914"><a href="#local-6989586621679031914"><span class="hs-identifier">takeAbs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031928"><a href="#local-6989586621679031928"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031928"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span class="hs-special">]</span><span>
</span><a name="line-647"></a><span>        </span><span class="hs-identifier">takeAbs</span><span> </span><a name="local-6989586621679031929"><a href="#local-6989586621679031929"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679031930"><a href="#local-6989586621679031930"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031930"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">toLower</span><span> </span><a href="#local-6989586621679031930"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-var">takeDrive</span></a><span> </span><a href="#local-6989586621679031929"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-648"></a><span>
</span><a name="line-649"></a><span class="hs-comment">-- | Normalise a file</span><span>
</span><a name="line-650"></a><span class="hs-comment">--</span><span>
</span><a name="line-651"></a><span class="hs-comment">-- * \/\/ outside of the drive can be made blank</span><span>
</span><a name="line-652"></a><span class="hs-comment">--</span><span>
</span><a name="line-653"></a><span class="hs-comment">-- * \/ -&gt; 'pathSeparator'</span><span>
</span><a name="line-654"></a><span class="hs-comment">--</span><span>
</span><a name="line-655"></a><span class="hs-comment">-- * .\/ -&gt; \&quot;\&quot;</span><span>
</span><a name="line-656"></a><span class="hs-comment">--</span><span>
</span><a name="line-657"></a><span class="hs-comment">-- &gt; Posix:   normalise &quot;/file/\\test////&quot; == &quot;/file/\\test/&quot;</span><span>
</span><a name="line-658"></a><span class="hs-comment">-- &gt; Posix:   normalise &quot;/file/./test&quot; == &quot;/file/test&quot;</span><span>
</span><a name="line-659"></a><span class="hs-comment">-- &gt; Posix:   normalise &quot;/test/file/../bob/fred/&quot; == &quot;/test/file/../bob/fred/&quot;</span><span>
</span><a name="line-660"></a><span class="hs-comment">-- &gt; Posix:   normalise &quot;../bob/fred/&quot; == &quot;../bob/fred/&quot;</span><span>
</span><a name="line-661"></a><span class="hs-comment">-- &gt; Posix:   normalise &quot;./bob/fred/&quot; == &quot;bob/fred/&quot;</span><span>
</span><a name="line-662"></a><span class="hs-comment">-- &gt; Windows: normalise &quot;c:\\file/bob\\&quot; == &quot;C:/file/bob/&quot;</span><span>
</span><a name="line-663"></a><span class="hs-comment">-- &gt; Windows: normalise &quot;c:/&quot; == &quot;C:/&quot;</span><span>
</span><a name="line-664"></a><span class="hs-comment">-- &gt; Windows: normalise &quot;\\\\server\\test&quot; == &quot;\\\\server\\test&quot; -- xxx</span><span>
</span><a name="line-665"></a><span class="hs-comment">-- &gt; Windows: normalise &quot;.&quot; == &quot;.&quot;</span><span>
</span><a name="line-666"></a><span class="hs-comment">-- &gt; Posix:   normalise &quot;./&quot; == &quot;./&quot;</span><span>
</span><a name="line-667"></a><span class="hs-identifier">normalise</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-668"></a><a name="normalise"><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier">normalise</span></a></a><span> </span><a name="local-6989586621679031931"><a href="#local-6989586621679031931"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-var">joinDrive</span></a><span> </span><span class="hs-special">(</span><a href="System.EasyFile.FilePath.html#normaliseDrive"><span class="hs-identifier hs-var">normaliseDrive</span></a><span> </span><a href="#local-6989586621679031932"><span class="hs-identifier hs-var">drv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031934"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679031933"><span class="hs-identifier hs-var">pth</span></a><span class="hs-special">)</span><span>
</span><a name="line-669"></a><span>              </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031933"><span class="hs-identifier hs-var">pth</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679031933"><span class="hs-identifier hs-var">pth</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-670"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-671"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679031932"><a href="#local-6989586621679031932"><span class="hs-identifier">drv</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031933"><a href="#local-6989586621679031933"><span class="hs-identifier">pth</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a><span> </span><a href="#local-6989586621679031931"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-672"></a><span>
</span><a name="line-673"></a><span>        </span><a name="local-6989586621679031934"><a href="#local-6989586621679031934"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#joinPath"><span class="hs-identifier hs-var">joinPath</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679031936"><span class="hs-identifier hs-var">dropDots</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#splitDirectories"><span class="hs-identifier hs-var">splitDirectories</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679031935"><span class="hs-identifier hs-var">propSep</span></a><span>
</span><a name="line-674"></a><span>
</span><a name="line-675"></a><span>        </span><a name="local-6989586621679031935"><a href="#local-6989586621679031935"><span class="hs-identifier">propSep</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031937"><a href="#local-6989586621679031937"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031938"><a href="#local-6989586621679031938"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031939"><a href="#local-6989586621679031939"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-676"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031937"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031938"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031935"><span class="hs-identifier hs-var">propSep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031937"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679031939"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-677"></a><span>        </span><span class="hs-identifier">propSep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031940"><a href="#local-6989586621679031940"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031941"><a href="#local-6989586621679031941"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-678"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031940"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679031935"><span class="hs-identifier hs-var">propSep</span></a><span> </span><a href="#local-6989586621679031941"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-679"></a><span>        </span><span class="hs-identifier">propSep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031942"><a href="#local-6989586621679031942"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031943"><a href="#local-6989586621679031943"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031942"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679031935"><span class="hs-identifier hs-var">propSep</span></a><span> </span><a href="#local-6989586621679031943"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-680"></a><span>        </span><span class="hs-identifier">propSep</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-681"></a><span>
</span><a name="line-682"></a><span>        </span><a name="local-6989586621679031936"><a href="#local-6989586621679031936"><span class="hs-identifier">dropDots</span></a></a><span> </span><a name="local-6989586621679031944"><a href="#local-6989586621679031944"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;.&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679031945"><a href="#local-6989586621679031945"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031945"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031936"><span class="hs-identifier hs-var">dropDots</span></a><span> </span><a href="#local-6989586621679031944"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679031945"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-683"></a><span>        </span><span class="hs-identifier">dropDots</span><span> </span><a name="local-6989586621679031946"><a href="#local-6989586621679031946"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031947"><a href="#local-6989586621679031947"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031948"><a href="#local-6989586621679031948"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031936"><span class="hs-identifier hs-var">dropDots</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031947"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679031946"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031948"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-684"></a><span>        </span><span class="hs-identifier">dropDots</span><span> </span><a name="local-6989586621679031949"><a href="#local-6989586621679031949"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679031949"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span class="hs-identifier">normaliseDrive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-687"></a><a name="normaliseDrive"><a href="System.EasyFile.FilePath.html#normaliseDrive"><span class="hs-identifier">normaliseDrive</span></a></a><span> </span><a name="local-6989586621679031950"><a href="#local-6989586621679031950"><span class="hs-identifier">drive</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier hs-var">isPosix</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031950"><span class="hs-identifier hs-var">drive</span></a><span>
</span><a name="line-688"></a><span class="hs-identifier">normaliseDrive</span><span> </span><a name="local-6989586621679031951"><a href="#local-6989586621679031951"><span class="hs-identifier">drive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a><span> </span><a href="#local-6989586621679031952"><span class="hs-identifier hs-var">x2</span></a><span>
</span><a name="line-689"></a><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">toUpper</span><span> </span><a href="#local-6989586621679031952"><span class="hs-identifier hs-var">x2</span></a><span>
</span><a name="line-690"></a><span>                       </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031951"><span class="hs-identifier hs-var">drive</span></a><span>
</span><a name="line-691"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-692"></a><span>        </span><a name="local-6989586621679031952"><a href="#local-6989586621679031952"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679031953"><span class="hs-identifier hs-var">repSlash</span></a><span> </span><a href="#local-6989586621679031951"><span class="hs-identifier hs-var">drive</span></a><span>
</span><a name="line-693"></a><span>
</span><a name="line-694"></a><span>        </span><a name="local-6989586621679031953"><a href="#local-6989586621679031953"><span class="hs-identifier">repSlash</span></a></a><span> </span><a name="local-6989586621679031954"><a href="#local-6989586621679031954"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><a href="#local-6989586621679031954"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679031954"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-comment">{- xxx
-- information for validity functions on Windows
-- see http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/naming_a_file.asp
badCharacters :: [Char]
badCharacters = &quot;:*?&gt;&lt;|\&quot;&quot;
badElements :: [FilePath]
badElements = [&quot;CON&quot;, &quot;PRN&quot;, &quot;AUX&quot;, &quot;NUL&quot;, &quot;COM1&quot;, &quot;COM2&quot;, &quot;COM3&quot;, &quot;COM4&quot;, &quot;COM5&quot;, &quot;COM6&quot;, &quot;COM7&quot;, &quot;COM8&quot;, &quot;COM9&quot;, &quot;LPT1&quot;, &quot;LPT2&quot;, &quot;LPT3&quot;, &quot;LPT4&quot;, &quot;LPT5&quot;, &quot;LPT6&quot;, &quot;LPT7&quot;, &quot;LPT8&quot;, &quot;LPT9&quot;, &quot;CLOCK$&quot;]

-- | Is a FilePath valid, i.e. could you create a file like it?
--
-- &gt;          isValid &quot;&quot; == False
-- &gt; Posix:   isValid &quot;/random_ path:*&quot; == True
-- &gt; Posix:   isValid x == not (null x)
-- &gt; Windows: isValid &quot;c:\\test&quot; == True
-- &gt; Windows: isValid &quot;c:\\test:of_test&quot; == False
-- &gt; Windows: isValid &quot;test*&quot; == False
-- &gt; Windows: isValid &quot;c:\\test\\nul&quot; == False
-- &gt; Windows: isValid &quot;c:\\test\\prn.txt&quot; == False
-- &gt; Windows: isValid &quot;c:\\nul\\file&quot; == False
-- &gt; Windows: isValid &quot;\\\\&quot; == False
isValid :: FilePath -&gt; Bool
isValid &quot;&quot; = False
isValid _ | isPosix = True
isValid path =
        not (any (`elem` badCharacters) x2) &amp;&amp;
        not (any f $ splitDirectories x2) &amp;&amp;
        not (length path &gt;= 2 &amp;&amp; all isPathSeparator path)
    where
        x2 = dropDrive path
        f x = map toUpper (dropExtensions x) `elem` badElements


-- | Take a FilePath and make it valid; does not change already valid FilePaths.
--
-- &gt; isValid (makeValid x)
-- &gt; isValid x ==&gt; makeValid x == x
-- &gt; makeValid &quot;&quot; == &quot;_&quot;
-- &gt; Windows: makeValid &quot;c:\\test:of_test&quot; == &quot;c:\\test_of_test&quot;
-- &gt; Windows: makeValid &quot;test*&quot; == &quot;test_&quot;
-- &gt; Windows: makeValid &quot;c:\\test\\nul&quot; == &quot;c:\\test\\nul_&quot;
-- &gt; Windows: makeValid &quot;c:\\test\\prn.txt&quot; == &quot;c:\\test\\prn_.txt&quot;
-- &gt; Windows: makeValid &quot;c:\\test/prn.txt&quot; == &quot;c:\\test/prn_.txt&quot;
-- &gt; Windows: makeValid &quot;c:\\nul\\file&quot; == &quot;c:\\nul_\\file&quot;
makeValid :: FilePath -&gt; FilePath
makeValid &quot;&quot; = &quot;_&quot;
makeValid path | isPosix = path
makeValid x | length x &gt;= 2 &amp;&amp; all isPathSeparator x = take 2 x ++ &quot;drive&quot;
makeValid path = joinDrive drv $ validElements $ validChars pth
    where
        (drv,pth) = splitDrive path

        validChars x = map f x
        f x | x `elem` badCharacters = '_'
            | otherwise = x

        validElements x = joinPath $ map g $ splitPath x
        g x = h (reverse b) ++ reverse a
            where (a,b) = span isPathSeparator $ reverse x
        h x = if map toUpper a `elem` badElements then a ++ &quot;_&quot; &lt;.&gt; b else x
            where (a,b) = splitExtensions x
-}</span><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span class="hs-comment">-- | Is a path relative, or is it fixed to the root?</span><span>
</span><a name="line-759"></a><span class="hs-comment">--</span><span>
</span><a name="line-760"></a><span class="hs-comment">-- &gt; Windows: isRelative &quot;path\\test&quot; == True</span><span>
</span><a name="line-761"></a><span class="hs-comment">-- &gt; Windows: isRelative &quot;c:\\test&quot; == False</span><span>
</span><a name="line-762"></a><span class="hs-comment">-- &gt; Windows: isRelative &quot;c:test&quot; == True</span><span>
</span><a name="line-763"></a><span class="hs-comment">-- &gt; Windows: isRelative &quot;c:&quot; == True</span><span>
</span><a name="line-764"></a><span class="hs-comment">-- &gt; Windows: isRelative &quot;\\\\foo&quot; == False</span><span>
</span><a name="line-765"></a><span class="hs-comment">-- &gt; Windows: isRelative &quot;/foo&quot; == True</span><span>
</span><a name="line-766"></a><span class="hs-comment">-- &gt; Posix:   isRelative &quot;test/path&quot; == True</span><span>
</span><a name="line-767"></a><span class="hs-comment">-- &gt; Posix:   isRelative &quot;/test&quot; == False</span><span>
</span><a name="line-768"></a><span class="hs-identifier">isRelative</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-769"></a><a name="isRelative"><a href="System.EasyFile.FilePath.html#isRelative"><span class="hs-identifier">isRelative</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.EasyFile.FilePath.html#isRelativeDrive"><span class="hs-identifier hs-var">isRelativeDrive</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-var">takeDrive</span></a><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span>
</span><a name="line-772"></a><span class="hs-comment">-- &gt; isRelativeDrive &quot;&quot; == True</span><span>
</span><a name="line-773"></a><span class="hs-comment">-- &gt; Windows: isRelativeDrive &quot;c:\\&quot; == False</span><span>
</span><a name="line-774"></a><span class="hs-comment">-- &gt; Windows: isRelativeDrive &quot;c:/&quot; == False</span><span>
</span><a name="line-775"></a><span class="hs-comment">-- &gt; Windows: isRelativeDrive &quot;c:&quot; == True</span><span>
</span><a name="line-776"></a><span class="hs-comment">-- &gt; Windows: isRelativeDrive &quot;\\\\foo&quot; == False</span><span>
</span><a name="line-777"></a><span class="hs-comment">-- &gt; Posix:   isRelativeDrive &quot;/&quot; == False</span><span>
</span><a name="line-778"></a><span class="hs-identifier">isRelativeDrive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-779"></a><a name="isRelativeDrive"><a href="System.EasyFile.FilePath.html#isRelativeDrive"><span class="hs-identifier">isRelativeDrive</span></a></a><span> </span><a name="local-6989586621679031955"><a href="#local-6989586621679031955"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679031955"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-780"></a><span>    </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a><span> </span><a href="#local-6989586621679031955"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-781"></a><span>
</span><a name="line-782"></a><span>
</span><a name="line-783"></a><span class="hs-comment">-- | @not . 'isRelative'@</span><span>
</span><a name="line-784"></a><span class="hs-comment">--</span><span>
</span><a name="line-785"></a><span class="hs-comment">-- &gt; isAbsolute x == not (isRelative x)</span><span>
</span><a name="line-786"></a><span class="hs-identifier">isAbsolute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-787"></a><a name="isAbsolute"><a href="System.EasyFile.FilePath.html#isAbsolute"><span class="hs-identifier">isAbsolute</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.EasyFile.FilePath.html#isRelative"><span class="hs-identifier hs-var">isRelative</span></a><span>
</span><a name="line-788"></a><span>
</span><a name="line-789"></a><span class="hs-comment">{-
Copyright Neil Mitchell 2005-2007.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.

    * Neither the name of Neil Mitchell nor the names of other
      contributors may be used to endorse or promote products derived
      from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-}</span><span>
</span><a name="line-821"></a></pre></body></html>