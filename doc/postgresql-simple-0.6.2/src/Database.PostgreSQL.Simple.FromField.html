<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, DeriveDataTypeable, DeriveFunctor  #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances, TypeSynonymInstances #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE PatternGuards, ScopedTypeVariables      #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE RecordWildCards                         #-}</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-comment">{- |
Module:      Database.PostgreSQL.Simple.FromField
Copyright:   (c) 2011 MailRank, Inc.
             (c) 2011-2013 Leon P Smith
License:     BSD3
Maintainer:  Leon P Smith &lt;leon@melding-monads.com&gt;
Stability:   experimental

The 'FromField' typeclass, for converting a single value in a row
returned by a SQL query into a more useful Haskell representation.
Note that each instance of 'FromField' is documented by a list of
compatible postgresql types.

A Haskell numeric type is considered to be compatible with all
PostgreSQL numeric types that are less accurate than it. For instance,
the Haskell 'Double' type is compatible with the PostgreSQL's 32-bit
@int@ type because it can represent a @int@ exactly.  On the other hand,
since a 'Double' might lose precision if representing PostgreSQL's 64-bit
@bigint@, the two are /not/ considered compatible.

Note that the 'Float' and 'Double' instances use attoparsec's 'double'
conversion routine,  which sacrifices some accuracy for speed.   If you
need accuracy,  consider first converting data to a 'Scientific' or 'Rational'
type,  and then converting to a floating-point type.   If you are defining
your own 'Database.PostgreSQL.Simple.FromRow.FromRow' instances,  this can be
achieved simply by
@'fromRational' '&lt;$&gt;' 'Database.PostgreSQL.Simple.FromRow.field'@,  although
this idiom is additionally compatible with PostgreSQL's @int8@ and @numeric@
types.  If this is unacceptable,  you may find
'Database.PostgreSQL.Simple.FromRow.fieldWith' useful.

Also note that while converting to a 'Double' through the 'Scientific' type
is likely somewhat faster than converting through the 'Rational' type,
the 'Scientific' type has no way to represent @NaN@ and @&#177;Infinity@ values.
Thus,  if you need precision conversion of regular floating point values
and the possibility of receiving these special values from the backend,
stick with 'Rational'.

Because 'FromField' is a typeclass,  one may provide conversions to
additional Haskell types without modifying postgresql-simple.  This is
particularly useful for supporting PostgreSQL types that postgresql-simple
does not support out-of-box.  Here's an example of what such an instance
might look like for a UUID type that implements the @Read@ class:

@
import Data.UUID ( UUID )
import Database.PostgreSQL.Simple.FromField
       ( FromField (fromField) , typeOid, returnError, ResultError (..) )
import Database.PostgreSQL.Simple.TypeInfo.Static (typoid, uuid)
import qualified Data.ByteString.Char8 as B

instance FromField UUID where
   fromField f mdata =
      if typeOid f /= typoid uuid
        then returnError Incompatible f \&quot;\&quot;
        else case B.unpack \`fmap\` mdata of
               Nothing  -&gt; returnError UnexpectedNull f \&quot;\&quot;
               Just dat -&gt;
                  case [ x | (x,t) &lt;- reads dat, (\&quot;\&quot;,\&quot;\&quot;) &lt;- lex t ] of
                    [x] -&gt; return x
                    _   -&gt; returnError ConversionFailed f dat
@

Note that because PostgreSQL's @uuid@ type is built into postgres and is
not provided by an extension,  the 'typeOid' of @uuid@ does not change and
thus we can examine it directly.  One could hard-code the type oid,  or
obtain it by other means, but in this case we simply pull it out of the
static table provided by postgresql-simple.

On the other hand if the type is provided by an extension,  such as
@PostGIS@ or @hstore@,  then the 'typeOid' is not stable and can vary from
database to database. In this case it is recommended that FromField
instances use 'typename' instead.

-}</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.PostgreSQL.Simple.FromField</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-85"></a><span>      </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#runConversion"><span class="hs-identifier hs-var">runConversion</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#conversionMap"><span class="hs-identifier hs-var">conversionMap</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#conversionError"><span class="hs-identifier hs-var">conversionError</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ResultError"><span class="hs-identifier hs-type">ResultError</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typename"><span class="hs-identifier hs-var">typename</span></a><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Types.html#TypeInfo"><span class="hs-identifier hs-type">TypeInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Types.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typeInfo"><span class="hs-identifier hs-var">typeInfo</span></a><span>
</span><a name="line-100"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typeInfoByOid"><span class="hs-identifier hs-var">typeInfoByOid</span></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#name"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#tableOid"><span class="hs-identifier hs-var">tableOid</span></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#tableColumn"><span class="hs-identifier hs-var">tableColumn</span></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#format"><span class="hs-identifier hs-var">format</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#typeOid"><span class="hs-identifier hs-var">typeOid</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PQ.Format</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#pgArrayFieldParser"><span class="hs-identifier hs-var">pgArrayFieldParser</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#optionalField"><span class="hs-identifier hs-var">optionalField</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromJSONField"><span class="hs-identifier hs-var">fromJSONField</span></a><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-cpp">#include &quot;MachDeps.h&quot;
</span><span>
</span><a name="line-116"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Applicative</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Concurrent.MVar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MVar</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">newMVar</span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Exception</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Exception</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Aeson</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">JSON</span><span>
</span><a name="line-120"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Aeson.Internal</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">JSON</span><span>
</span><a name="line-121"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Aeson.Parser</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">JSON</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">value'</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Attoparsec.ByteString.Char8</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Result</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Char8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span>
</span><a name="line-125"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Int</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int16</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int32</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int64</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.IORef</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IORef</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Ratio</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ratio</span><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Time</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">UTCTime</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ZonedTime</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">LocalTime</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Day</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeOf</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Vector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Vector.Mutable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IOVector</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Vector</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span>
</span><a name="line-133"></a><span class="hs-keyword">import</span><span>           </span><a href="Database.PostgreSQL.Simple.Internal.html"><span class="hs-identifier">Database.PostgreSQL.Simple.Internal</span></a><span>
</span><a name="line-134"></a><span class="hs-keyword">import</span><span>           </span><a href="Database.PostgreSQL.Simple.Compat.html"><span class="hs-identifier">Database.PostgreSQL.Simple.Compat</span></a><span>
</span><a name="line-135"></a><span class="hs-keyword">import</span><span>           </span><a href="Database.PostgreSQL.Simple.Ok.html"><span class="hs-identifier">Database.PostgreSQL.Simple.Ok</span></a><span>
</span><a name="line-136"></a><span class="hs-keyword">import</span><span>           </span><a href="Database.PostgreSQL.Simple.Types.html"><span class="hs-identifier">Database.PostgreSQL.Simple.Types</span></a><span>
</span><a name="line-137"></a><span class="hs-keyword">import</span><span>           </span><a href="Database.PostgreSQL.Simple.TypeInfo.html"><span class="hs-identifier">Database.PostgreSQL.Simple.TypeInfo</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TI</span><span>
</span><a name="line-138"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html"><span class="hs-identifier">Database.PostgreSQL.Simple.TypeInfo.Static</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TI</span><span>
</span><a name="line-139"></a><span class="hs-keyword">import</span><span>           </span><a href="Database.PostgreSQL.Simple.Time.html"><span class="hs-identifier">Database.PostgreSQL.Simple.Time</span></a><span>
</span><a name="line-140"></a><span class="hs-keyword">import</span><span>           </span><a href="Database.PostgreSQL.Simple.Arrays.html"><span class="hs-identifier">Database.PostgreSQL.Simple.Arrays</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Arrays</span><span>
</span><a name="line-141"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Database.PostgreSQL.LibPQ</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">PQ</span><span>
</span><a name="line-142"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SB</span><span>
</span><a name="line-143"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Char8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B8</span><span>
</span><a name="line-144"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LB</span><span>
</span><a name="line-145"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">ST</span><span>
</span><a name="line-146"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text.Encoding</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">ST</span><span>
</span><a name="line-147"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text.Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LT</span><span>
</span><a name="line-148"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.CaseInsensitive</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CI</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.CaseInsensitive</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CI</span><span>
</span><a name="line-150"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.UUID.Types</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-type">UUID</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.UUID.Types</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">UUID</span><span>
</span><a name="line-152"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Scientific</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Scientific</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Real</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">infinity</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">notANumber</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-comment">-- | Exception thrown if conversion from a SQL value to a Haskell</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- value fails.</span><span>
</span><a name="line-157"></a><span class="hs-keyword">data</span><span> </span><a name="ResultError"><a href="Database.PostgreSQL.Simple.FromField.html#ResultError"><span class="hs-identifier">ResultError</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Incompatible"><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier">Incompatible</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="errSQLType"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLType"><span class="hs-identifier">errSQLType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-158"></a><span>                                </span><span class="hs-special">,</span><span> </span><a name="errSQLTableOid"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLTableOid"><span class="hs-identifier">errSQLTableOid</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span>
</span><a name="line-159"></a><span>                                </span><span class="hs-special">,</span><span> </span><a name="errSQLField"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLField"><span class="hs-identifier">errSQLField</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-160"></a><span>                                </span><span class="hs-special">,</span><span> </span><a name="errHaskellType"><a href="Database.PostgreSQL.Simple.FromField.html#errHaskellType"><span class="hs-identifier">errHaskellType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-161"></a><span>                                </span><span class="hs-special">,</span><span> </span><a name="errMessage"><a href="Database.PostgreSQL.Simple.FromField.html#errMessage"><span class="hs-identifier">errMessage</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-162"></a><span>                 </span><span class="hs-comment">-- ^ The SQL and Haskell types are not compatible.</span><span>
</span><a name="line-163"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="UnexpectedNull"><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier">UnexpectedNull</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="errSQLType"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLType"><span class="hs-identifier">errSQLType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-164"></a><span>                                  </span><span class="hs-special">,</span><span> </span><a name="errSQLTableOid"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLTableOid"><span class="hs-identifier">errSQLTableOid</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span>
</span><a name="line-165"></a><span>                                  </span><span class="hs-special">,</span><span> </span><a name="errSQLField"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLField"><span class="hs-identifier">errSQLField</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-166"></a><span>                                  </span><span class="hs-special">,</span><span> </span><a name="errHaskellType"><a href="Database.PostgreSQL.Simple.FromField.html#errHaskellType"><span class="hs-identifier">errHaskellType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-167"></a><span>                                  </span><span class="hs-special">,</span><span> </span><a name="errMessage"><a href="Database.PostgreSQL.Simple.FromField.html#errMessage"><span class="hs-identifier">errMessage</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-168"></a><span>                 </span><span class="hs-comment">-- ^ A SQL @NULL@ was encountered when the Haskell</span><span>
</span><a name="line-169"></a><span>                 </span><span class="hs-comment">-- type did not permit it.</span><span>
</span><a name="line-170"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="ConversionFailed"><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier">ConversionFailed</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="errSQLType"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLType"><span class="hs-identifier">errSQLType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-171"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a name="errSQLTableOid"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLTableOid"><span class="hs-identifier">errSQLTableOid</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span>
</span><a name="line-172"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a name="errSQLField"><a href="Database.PostgreSQL.Simple.FromField.html#errSQLField"><span class="hs-identifier">errSQLField</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-173"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a name="errHaskellType"><a href="Database.PostgreSQL.Simple.FromField.html#errHaskellType"><span class="hs-identifier">errHaskellType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-174"></a><span>                                    </span><span class="hs-special">,</span><span> </span><a name="errMessage"><a href="Database.PostgreSQL.Simple.FromField.html#errMessage"><span class="hs-identifier">errMessage</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-175"></a><span>                 </span><span class="hs-comment">-- ^ The SQL value could not be parsed, or could not</span><span>
</span><a name="line-176"></a><span>                 </span><span class="hs-comment">-- be represented as a valid Haskell value, or an</span><span>
</span><a name="line-177"></a><span>                 </span><span class="hs-comment">-- unexpected low-level error occurred (e.g. mismatch</span><span>
</span><a name="line-178"></a><span>                 </span><span class="hs-comment">-- between metadata and actual data in a row).</span><span>
</span><a name="line-179"></a><span>                   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Exception</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ResultError"><span class="hs-identifier hs-type">ResultError</span></a><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">left</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Exception</span><span> </span><a href="#local-6989586621679137970"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679137970"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="#local-6989586621679137971"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-184"></a><a name="left"><a href="Database.PostgreSQL.Simple.FromField.html#left"><span class="hs-identifier">left</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#conversionError"><span class="hs-identifier hs-var">conversionError</span></a><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-keyword">type</span><span> </span><a name="FieldParser"><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier">FieldParser</span></a></a><span> </span><a name="local-6989586621679135133"><a href="#local-6989586621679135133"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="#local-6989586621679135133"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- | A type that may be converted from a SQL type.</span><span>
</span><a name="line-189"></a><span class="hs-keyword">class</span><span> </span><a name="FromField"><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier">FromField</span></a></a><span> </span><a name="local-6989586621679135132"><a href="#local-6989586621679135132"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-190"></a><span>    </span><a name="fromField"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a><span> </span><a href="#local-6989586621679135132"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-191"></a><span>    </span><span class="hs-comment">-- ^ Convert a SQL value to a Haskell value.</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-193"></a><span>    </span><span class="hs-comment">-- Returns a list of exceptions if the conversion fails.  In the case of</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-comment">-- library instances,  this will usually be a single 'ResultError',  but</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-comment">-- may be a 'UnicodeException'.</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-comment">-- Note that retaining any reference to the 'Field' argument causes</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-comment">-- the entire @LibPQ.'PQ.Result'@ to be retained.  Thus, implementations</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-comment">-- of 'fromField' should return results that do not refer to this value</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-comment">-- after the result have been evaluated to WHNF.</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-comment">-- Note that as of @postgresql-simple-0.4.0.0@,  the 'ByteString' value</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-comment">-- has already been copied out of the @LibPQ.'PQ.Result'@ before it has</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-comment">-- been passed to 'fromField'.  This is because for short strings, it's</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-comment">-- cheaper to copy the string than to set up a finalizer.</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- | Returns the data type name.  This is the preferred way of identifying</span><span>
</span><a name="line-208"></a><span class="hs-comment">--   types that do not have a stable type oid, such as types provided by</span><span>
</span><a name="line-209"></a><span class="hs-comment">--   extensions to PostgreSQL.</span><span>
</span><a name="line-210"></a><span class="hs-comment">--</span><span>
</span><a name="line-211"></a><span class="hs-comment">--   More concretely,  it returns the @typname@ column associated with the</span><span>
</span><a name="line-212"></a><span class="hs-comment">--   type oid in the @pg_type@ table.  First, postgresql-simple will check</span><span>
</span><a name="line-213"></a><span class="hs-comment">--   the built-in, static table.   If the type oid is not there,</span><span>
</span><a name="line-214"></a><span class="hs-comment">--   postgresql-simple will check a per-connection cache,  and then</span><span>
</span><a name="line-215"></a><span class="hs-comment">--   finally query the database's meta-schema.</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-identifier">typename</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-218"></a><a name="typename"><a href="Database.PostgreSQL.Simple.FromField.html#typename"><span class="hs-identifier">typename</span></a></a><span> </span><a name="local-6989586621679137972"><a href="#local-6989586621679137972"><span class="hs-identifier">field</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">typname</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typeInfo"><span class="hs-identifier hs-var">typeInfo</span></a><span> </span><a href="#local-6989586621679137972"><span class="hs-identifier hs-var">field</span></a><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-identifier">typeInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Types.html#TypeInfo"><span class="hs-identifier hs-type">TypeInfo</span></a><span>
</span><a name="line-221"></a><a name="typeInfo"><a href="Database.PostgreSQL.Simple.FromField.html#typeInfo"><span class="hs-identifier">typeInfo</span></a></a><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-var">Field</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-var">Conversion</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679137976"><a href="#local-6989586621679137976"><span class="hs-identifier">conn</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-222"></a><span>                       </span><a href="Database.PostgreSQL.Simple.Ok.html#Ok"><span class="hs-identifier hs-var">Ok</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.TypeInfo.html#getTypeInfo"><span class="hs-identifier hs-var">getTypeInfo</span></a><span> </span><a href="#local-6989586621679137976"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="#local-6989586621679137975"><span class="hs-identifier hs-var">typeOid</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-identifier">typeInfoByOid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Types.html#TypeInfo"><span class="hs-identifier hs-type">TypeInfo</span></a><span>
</span><a name="line-225"></a><a name="typeInfoByOid"><a href="Database.PostgreSQL.Simple.FromField.html#typeInfoByOid"><span class="hs-identifier">typeInfoByOid</span></a></a><span> </span><a name="local-6989586621679137977"><a href="#local-6989586621679137977"><span class="hs-identifier">oid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-var">Conversion</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679137978"><a href="#local-6989586621679137978"><span class="hs-identifier">conn</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-226"></a><span>                      </span><a href="Database.PostgreSQL.Simple.Ok.html#Ok"><span class="hs-identifier hs-var">Ok</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.TypeInfo.html#getTypeInfo"><span class="hs-identifier hs-var">getTypeInfo</span></a><span> </span><a href="#local-6989586621679137978"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="#local-6989586621679137977"><span class="hs-identifier hs-var">oid</span></a><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-comment">-- | Returns the name of the column.  This is often determined by a table</span><span>
</span><a name="line-229"></a><span class="hs-comment">--   definition,  but it can be set using an @as@ clause.</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-232"></a><a name="name"><a href="Database.PostgreSQL.Simple.FromField.html#name"><span class="hs-identifier">name</span></a></a><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-var">Field</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PQ.fname</span><span> </span><a href="#local-6989586621679137979"><span class="hs-identifier hs-var">result</span></a><span> </span><a href="#local-6989586621679137980"><span class="hs-identifier hs-var">column</span></a><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">-- | Returns the name of the object id of the @table@ associated with the</span><span>
</span><a name="line-235"></a><span class="hs-comment">--   column,  if any.  Returns 'Nothing' when there is no such table;</span><span>
</span><a name="line-236"></a><span class="hs-comment">--   for example a computed column does not have a table associated with it.</span><span>
</span><a name="line-237"></a><span class="hs-comment">--   Analogous to libpq's @PQftable@.</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-identifier">tableOid</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span>
</span><a name="line-240"></a><a name="tableOid"><a href="Database.PostgreSQL.Simple.FromField.html#tableOid"><span class="hs-identifier">tableOid</span></a></a><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-var">Field</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679137985"><span class="hs-identifier hs-var">toMaybeOid</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PQ.ftable</span><span> </span><a href="#local-6989586621679137982"><span class="hs-identifier hs-var">result</span></a><span> </span><a href="#local-6989586621679137983"><span class="hs-identifier hs-var">column</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-242"></a><span>     </span><a name="local-6989586621679137985"><a href="#local-6989586621679137985"><span class="hs-identifier">toMaybeOid</span></a></a><span> </span><a name="local-6989586621679137986"><a href="#local-6989586621679137986"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-243"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span>   </span><a href="#local-6989586621679137986"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">PQ.invalidOid</span><span>
</span><a name="line-244"></a><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-245"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679137986"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-comment">-- | If the column has a table associated with it,  this returns the number</span><span>
</span><a name="line-248"></a><span class="hs-comment">--   off the associated table column.   Numbering starts from 0.  Analogous</span><span>
</span><a name="line-249"></a><span class="hs-comment">--   to libpq's @PQftablecol@.</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-identifier">tableColumn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-252"></a><a name="tableColumn"><a href="Database.PostgreSQL.Simple.FromField.html#tableColumn"><span class="hs-identifier">tableColumn</span></a></a><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-var">Field</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679137990"><span class="hs-identifier hs-var">fromCol</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PQ.ftablecol</span><span> </span><a href="#local-6989586621679137987"><span class="hs-identifier hs-var">result</span></a><span> </span><a href="#local-6989586621679137988"><span class="hs-identifier hs-var">column</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-254"></a><span>    </span><a name="local-6989586621679137990"><a href="#local-6989586621679137990"><span class="hs-identifier">fromCol</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PQ.Col</span><span> </span><a name="local-6989586621679137991"><a href="#local-6989586621679137991"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679137991"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-comment">-- | This returns whether the data was returned in a binary or textual format.</span><span>
</span><a name="line-257"></a><span class="hs-comment">--   Analogous to libpq's @PQfformat@.</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-identifier">format</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PQ.Format</span><span>
</span><a name="line-260"></a><a name="format"><a href="Database.PostgreSQL.Simple.FromField.html#format"><span class="hs-identifier">format</span></a></a><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-var">Field</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PQ.fformat</span><span> </span><a href="#local-6989586621679137992"><span class="hs-identifier hs-var">result</span></a><span> </span><a href="#local-6989586621679137993"><span class="hs-identifier hs-var">column</span></a><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-comment">-- | void</span><span>
</span><a name="line-263"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-264"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135325"><a href="#local-6989586621679135325"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135326"><a href="#local-6989586621679135326"><span class="hs-identifier">_bs</span></a></a><span>
</span><a name="line-265"></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679135325"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#voidOid"><span class="hs-identifier hs-var">TI.voidOid</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679135325"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-266"></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- | For dealing with null values.  Compatible with any postgresql type</span><span>
</span><a name="line-269"></a><span class="hs-comment">--   compatible with type @a@.  Note that the type is not checked if</span><span>
</span><a name="line-270"></a><span class="hs-comment">--   the value is null, although it is inadvisable to rely on this</span><span>
</span><a name="line-271"></a><span class="hs-comment">--   behavior.</span><span>
</span><a name="line-272"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="#local-6989586621679135324"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679135324"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-273"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#optionalField"><span class="hs-identifier hs-var">optionalField</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">-- | For dealing with SQL @null@ values outside of the 'FromField' class.</span><span>
</span><a name="line-276"></a><span class="hs-comment">--   Alternatively, one could use 'Control.Applicative.optional',  but that</span><span>
</span><a name="line-277"></a><span class="hs-comment">--   also turns type and conversion errors into 'Nothing',  whereas this is</span><span>
</span><a name="line-278"></a><span class="hs-comment">--   more specific and turns only @null@ values into 'Nothing'.</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-identifier">optionalField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a><span> </span><a href="#local-6989586621679137969"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679137969"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-281"></a><a name="optionalField"><a href="Database.PostgreSQL.Simple.FromField.html#optionalField"><span class="hs-identifier">optionalField</span></a></a><span> </span><a name="local-6989586621679137995"><a href="#local-6989586621679137995"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679137996"><a href="#local-6989586621679137996"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679137997"><a href="#local-6989586621679137997"><span class="hs-identifier">mv</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679137997"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-283"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-284"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679137995"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679137996"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679137997"><span class="hs-identifier hs-var">mv</span></a><span>
</span><a name="line-285"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">optionalField</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-comment">-- | compatible with any data type,  but the value must be null</span><span>
</span><a name="line-288"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="Database.PostgreSQL.Simple.Types.html#Null"><span class="hs-identifier hs-type">Null</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-289"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Database.PostgreSQL.Simple.Types.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-290"></a><span>    </span><span class="hs-identifier">fromField</span><span> </span><a name="local-6989586621679135323"><a href="#local-6989586621679135323"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679135323"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;data is not null&quot;</span><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span class="hs-comment">-- | bool</span><span>
</span><a name="line-293"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-294"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135321"><a href="#local-6989586621679135321"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135322"><a href="#local-6989586621679135322"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-295"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679135321"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#boolOid"><span class="hs-identifier hs-var">TI.boolOid</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679135321"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-296"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679135322"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><a href="#local-6989586621679135321"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-297"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679135322"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-string">&quot;t&quot;</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-298"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679135322"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-string">&quot;f&quot;</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-299"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679135321"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-comment">-- | \&quot;char\&quot;, bpchar</span><span>
</span><a name="line-302"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-303"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135318"><a href="#local-6989586621679135318"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135319"><a href="#local-6989586621679135319"><span class="hs-identifier">bs0</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-304"></a><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#charOid"><span class="hs-identifier hs-var">TI.charOid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#bpcharOid"><span class="hs-identifier hs-var">TI.bpcharOid</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679135318"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679135319"><span class="hs-identifier hs-var">bs0</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-306"></a><span>               </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><a href="#local-6989586621679135318"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-307"></a><span>               </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679135320"><a href="#local-6989586621679135320"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">B.length</span><span> </span><a href="#local-6989586621679135320"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-308"></a><span>                          </span><span class="hs-keyword">then</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679135318"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;length not 1&quot;</span><span>
</span><a name="line-309"></a><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">B.head</span><span> </span><a href="#local-6989586621679135320"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679135318"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-comment">-- | int2</span><span>
</span><a name="line-313"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Int16</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-314"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ok16"><span class="hs-identifier hs-var">ok16</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">signed</span><span> </span><span class="hs-identifier hs-var">decimal</span><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-comment">-- | int2, int4</span><span>
</span><a name="line-317"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Int32</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-318"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ok32"><span class="hs-identifier hs-var">ok32</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">signed</span><span> </span><span class="hs-identifier hs-var">decimal</span><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64
</span><span class="hs-comment">-- | int2, int4,  and if compiled as 64-bit code,  int8 as well.</span><span>
</span><a name="line-322"></a><span class="hs-comment">-- This library was compiled as 32-bit code.</span><span>
</span><a name="line-323"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- | int2, int4,  and if compiled as 64-bit code,  int8 as well.</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- This library was compiled as 64-bit code.</span><span>
</span><a name="line-326"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-328"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#okInt"><span class="hs-identifier hs-var">okInt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">signed</span><span> </span><span class="hs-identifier hs-var">decimal</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-comment">-- | int2, int4, int8</span><span>
</span><a name="line-331"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Int64</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-332"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ok64"><span class="hs-identifier hs-var">ok64</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">signed</span><span> </span><span class="hs-identifier hs-var">decimal</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-comment">-- | int2, int4, int8</span><span>
</span><a name="line-335"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-336"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ok64"><span class="hs-identifier hs-var">ok64</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">signed</span><span> </span><span class="hs-identifier hs-var">decimal</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- | int2, float4    (Uses attoparsec's 'double' routine,  for</span><span>
</span><a name="line-339"></a><span class="hs-comment">--   better accuracy convert to 'Scientific' or 'Rational' first)</span><span>
</span><a name="line-340"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Float</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-341"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="#local-6989586621679135317"><span class="hs-identifier hs-var">ok</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#pg_double"><span class="hs-identifier hs-var">pg_double</span></a><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679135317"><a href="#local-6989586621679135317"><span class="hs-identifier">ok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#float4Oid"><span class="hs-identifier hs-var">TI.float4Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int2Oid"><span class="hs-identifier hs-var">TI.int2Oid</span></a><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-comment">-- | int2, int4, float4, float8  (Uses attoparsec's 'double' routine,  for</span><span>
</span><a name="line-345"></a><span class="hs-comment">--   better accuracy convert to 'Scientific' or 'Rational' first)</span><span>
</span><a name="line-346"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-347"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="#local-6989586621679135316"><span class="hs-identifier hs-var">ok</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#pg_double"><span class="hs-identifier hs-var">pg_double</span></a><span>
</span><a name="line-348"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679135316"><a href="#local-6989586621679135316"><span class="hs-identifier">ok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#float4Oid"><span class="hs-identifier hs-var">TI.float4Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#float8Oid"><span class="hs-identifier hs-var">TI.float8Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int2Oid"><span class="hs-identifier hs-var">TI.int2Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int4Oid"><span class="hs-identifier hs-var">TI.int4Oid</span></a><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-comment">-- | int2, int4, int8, float4, float8, numeric</span><span>
</span><a name="line-351"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ratio</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-352"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="#local-6989586621679135315"><span class="hs-identifier hs-var">ok</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#pg_rational"><span class="hs-identifier hs-var">pg_rational</span></a><span>
</span><a name="line-353"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679135315"><a href="#local-6989586621679135315"><span class="hs-identifier">ok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#float4Oid"><span class="hs-identifier hs-var">TI.float4Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#float8Oid"><span class="hs-identifier hs-var">TI.float8Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int2Oid"><span class="hs-identifier hs-var">TI.int2Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int4Oid"><span class="hs-identifier hs-var">TI.int4Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int8Oid"><span class="hs-identifier hs-var">TI.int8Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span>  </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#numericOid"><span class="hs-identifier hs-var">TI.numericOid</span></a><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">-- | int2, int4, int8, float4, float8, numeric</span><span>
</span><a name="line-356"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Scientific</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-357"></a><span>     </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><a href="#local-6989586621679135314"><span class="hs-identifier hs-var">ok</span></a><span> </span><span class="hs-identifier hs-var">rational</span><span>
</span><a name="line-358"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679135314"><a href="#local-6989586621679135314"><span class="hs-identifier">ok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#float4Oid"><span class="hs-identifier hs-var">TI.float4Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#float8Oid"><span class="hs-identifier hs-var">TI.float8Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int2Oid"><span class="hs-identifier hs-var">TI.int2Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int4Oid"><span class="hs-identifier hs-var">TI.int4Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int8Oid"><span class="hs-identifier hs-var">TI.int8Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span>  </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#numericOid"><span class="hs-identifier hs-var">TI.numericOid</span></a><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-identifier">unBinary</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Types.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><a href="#local-6989586621679137968"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679137968"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-361"></a><a name="unBinary"><a href="Database.PostgreSQL.Simple.FromField.html#unBinary"><span class="hs-identifier">unBinary</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.Types.html#Binary"><span class="hs-identifier hs-var">Binary</span></a><span> </span><a name="local-6989586621679137998"><a href="#local-6989586621679137998"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679137998"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-identifier">pg_double</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-364"></a><a name="pg_double"><a href="Database.PostgreSQL.Simple.FromField.html#pg_double"><span class="hs-identifier">pg_double</span></a></a><span>
</span><a name="line-365"></a><span>    </span><span class="hs-glyph">=</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;NaN&quot;</span><span>       </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;Infinity&quot;</span><span>  </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;-Infinity&quot;</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-368"></a><span>    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">double</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-identifier">pg_rational</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-371"></a><a name="pg_rational"><a href="Database.PostgreSQL.Simple.FromField.html#pg_rational"><span class="hs-identifier">pg_rational</span></a></a><span>
</span><a name="line-372"></a><span>    </span><span class="hs-glyph">=</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;NaN&quot;</span><span>       </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">notANumber</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-373"></a><span>    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;Infinity&quot;</span><span>  </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">infinity</span><span>   </span><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;-Infinity&quot;</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-identifier hs-var">infinity</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">rational</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">-- | bytea, name, text, \&quot;char\&quot;, bpchar, varchar, unknown</span><span>
</span><a name="line-378"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">SB.ByteString</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-379"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135312"><a href="#local-6989586621679135312"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135313"><a href="#local-6989586621679135313"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679135312"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#byteaOid"><span class="hs-identifier hs-var">TI.byteaOid</span></a><span>
</span><a name="line-380"></a><span>                      </span><span class="hs-keyword">then</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#unBinary"><span class="hs-identifier hs-var">unBinary</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135312"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135313"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-381"></a><span>                      </span><span class="hs-keyword">else</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#doFromField"><span class="hs-identifier hs-var">doFromField</span></a><span> </span><a href="#local-6989586621679135312"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#okText%27"><span class="hs-identifier hs-var">okText'</span></a><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679135313"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-comment">-- | oid</span><span>
</span><a name="line-384"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-385"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135310"><a href="#local-6989586621679135310"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135311"><a href="#local-6989586621679135311"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PQ.Oid</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier hs-var">atto</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#oidOid"><span class="hs-identifier hs-var">TI.oidOid</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">decimal</span><span> </span><a href="#local-6989586621679135310"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135311"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-comment">-- | bytea, name, text, \&quot;char\&quot;, bpchar, varchar, unknown</span><span>
</span><a name="line-388"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">LB.ByteString</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-389"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135308"><a href="#local-6989586621679135308"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135309"><a href="#local-6989586621679135309"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LB.fromChunks</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135308"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135309"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-identifier">unescapeBytea</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SB.ByteString</span><span>
</span><a name="line-392"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.Types.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><span class="hs-identifier hs-type">SB.ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-393"></a><a name="unescapeBytea"><a href="Database.PostgreSQL.Simple.FromField.html#unescapeBytea"><span class="hs-identifier">unescapeBytea</span></a></a><span> </span><a name="local-6989586621679137999"><a href="#local-6989586621679137999"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679138000"><a href="#local-6989586621679138000"><span class="hs-identifier">str'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PQ.unescapeBytea</span><span> </span><a href="#local-6989586621679138000"><span class="hs-identifier hs-var">str'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-394"></a><span>       </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679137999"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;unescapeBytea failed&quot;</span><span>
</span><a name="line-395"></a><span>       </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679138001"><a href="#local-6989586621679138001"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.Types.html#Binary"><span class="hs-identifier hs-var">Binary</span></a><span> </span><a href="#local-6989586621679138001"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-comment">-- | bytea</span><span>
</span><a name="line-398"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.Types.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><span class="hs-identifier hs-type">SB.ByteString</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-399"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135306"><a href="#local-6989586621679135306"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135307"><a href="#local-6989586621679135307"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#format"><span class="hs-identifier hs-var">format</span></a><span> </span><a href="#local-6989586621679135306"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-400"></a><span>      </span><span class="hs-identifier hs-var">PQ.Text</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#doFromField"><span class="hs-identifier hs-var">doFromField</span></a><span> </span><a href="#local-6989586621679135306"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#okBinary"><span class="hs-identifier hs-var">okBinary</span></a><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#unescapeBytea"><span class="hs-identifier hs-var">unescapeBytea</span></a><span> </span><a href="#local-6989586621679135306"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679135307"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-401"></a><span>      </span><span class="hs-identifier hs-var">PQ.Binary</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#doFromField"><span class="hs-identifier hs-var">doFromField</span></a><span> </span><a href="#local-6989586621679135306"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#okBinary"><span class="hs-identifier hs-var">okBinary</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.PostgreSQL.Simple.Types.html#Binary"><span class="hs-identifier hs-var">Binary</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679135307"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-comment">-- | bytea</span><span>
</span><a name="line-404"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.Types.html#Binary"><span class="hs-identifier hs-type">Binary</span></a><span> </span><span class="hs-identifier hs-type">LB.ByteString</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-405"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135304"><a href="#local-6989586621679135304"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135305"><a href="#local-6989586621679135305"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Types.html#Binary"><span class="hs-identifier hs-var">Binary</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LB.fromChunks</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#unBinary"><span class="hs-identifier hs-var">unBinary</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135304"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135305"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span class="hs-comment">-- | name, text, \&quot;char\&quot;, bpchar, varchar</span><span>
</span><a name="line-408"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">ST.Text</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-409"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135303"><a href="#local-6989586621679135303"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#doFromField"><span class="hs-identifier hs-var">doFromField</span></a><span> </span><a href="#local-6989586621679135303"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#okText"><span class="hs-identifier hs-var">okText</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">either</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#left"><span class="hs-identifier hs-var">left</span></a><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ST.decodeUtf8'</span><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>    </span><span class="hs-comment">-- FIXME:  check character encoding</span><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span class="hs-comment">-- | name, text, \&quot;char\&quot;, bpchar, varchar</span><span>
</span><a name="line-413"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">LT.Text</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-414"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135301"><a href="#local-6989586621679135301"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135302"><a href="#local-6989586621679135302"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT.fromStrict</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135301"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135302"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span class="hs-comment">-- | citext</span><span>
</span><a name="line-417"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CI</span><span> </span><span class="hs-identifier hs-type">ST.Text</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-418"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135297"><a href="#local-6989586621679135297"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135298"><a href="#local-6989586621679135298"><span class="hs-identifier">mdat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-419"></a><span>       </span><a name="local-6989586621679135299"><a href="#local-6989586621679135299"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typename"><span class="hs-identifier hs-var">typename</span></a><span> </span><a href="#local-6989586621679135297"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-420"></a><span>       </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679135299"><span class="hs-identifier hs-var">typ</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;citext&quot;</span><span>
</span><a name="line-421"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679135297"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-422"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679135298"><span class="hs-identifier hs-var">mdat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-423"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><a href="#local-6989586621679135297"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-424"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679135300"><a href="#local-6989586621679135300"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#left"><span class="hs-identifier hs-var">left</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">CI.mk</span><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>                                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ST.decodeUtf8'</span><span> </span><a href="#local-6989586621679135300"><span class="hs-identifier hs-var">dat</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-comment">-- | citext</span><span>
</span><a name="line-428"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CI</span><span> </span><span class="hs-identifier hs-type">LT.Text</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-429"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135293"><a href="#local-6989586621679135293"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135294"><a href="#local-6989586621679135294"><span class="hs-identifier">mdat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-430"></a><span>       </span><a name="local-6989586621679135295"><a href="#local-6989586621679135295"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typename"><span class="hs-identifier hs-var">typename</span></a><span> </span><a href="#local-6989586621679135293"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-431"></a><span>       </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679135295"><span class="hs-identifier hs-var">typ</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;citext&quot;</span><span>
</span><a name="line-432"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679135293"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-433"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679135294"><span class="hs-identifier hs-var">mdat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-434"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><a href="#local-6989586621679135293"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-435"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679135296"><a href="#local-6989586621679135296"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#left"><span class="hs-identifier hs-var">left</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">CI.mk</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LT.fromStrict</span><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>                                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ST.decodeUtf8'</span><span> </span><a href="#local-6989586621679135296"><span class="hs-identifier hs-var">dat</span></a><span class="hs-special">)</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-comment">-- | name, text, \&quot;char\&quot;, bpchar, varchar</span><span>
</span><a name="line-439"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-440"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135291"><a href="#local-6989586621679135291"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135292"><a href="#local-6989586621679135292"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ST.unpack</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135291"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135292"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-441"></a><span>
</span><a name="line-442"></a><span class="hs-comment">-- | timestamptz</span><span>
</span><a name="line-443"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">UTCTime</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-444"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#timestamptzOid"><span class="hs-identifier hs-var">TI.timestamptzOid</span></a><span> </span><span class="hs-string">&quot;UTCTime&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseUTCTime"><span class="hs-identifier hs-var">parseUTCTime</span></a><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-comment">-- | timestamptz</span><span>
</span><a name="line-447"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">ZonedTime</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-448"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#timestamptzOid"><span class="hs-identifier hs-var">TI.timestamptzOid</span></a><span> </span><span class="hs-string">&quot;ZonedTime&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseZonedTime"><span class="hs-identifier hs-var">parseZonedTime</span></a><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span class="hs-comment">-- | timestamp</span><span>
</span><a name="line-451"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">LocalTime</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-452"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#timestampOid"><span class="hs-identifier hs-var">TI.timestampOid</span></a><span> </span><span class="hs-string">&quot;LocalTime&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseLocalTime"><span class="hs-identifier hs-var">parseLocalTime</span></a><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-comment">-- | date</span><span>
</span><a name="line-455"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">Day</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-456"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#dateOid"><span class="hs-identifier hs-var">TI.dateOid</span></a><span> </span><span class="hs-string">&quot;Day&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseDay"><span class="hs-identifier hs-var">parseDay</span></a><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-comment">-- | time</span><span>
</span><a name="line-459"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-460"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#timeOid"><span class="hs-identifier hs-var">TI.timeOid</span></a><span> </span><span class="hs-string">&quot;TimeOfDay&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseTimeOfDay"><span class="hs-identifier hs-var">parseTimeOfDay</span></a><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-comment">-- | timestamptz</span><span>
</span><a name="line-463"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#UTCTimestamp"><span class="hs-identifier hs-type">UTCTimestamp</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-464"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#timestamptzOid"><span class="hs-identifier hs-var">TI.timestamptzOid</span></a><span> </span><span class="hs-string">&quot;UTCTimestamp&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseUTCTimestamp"><span class="hs-identifier hs-var">parseUTCTimestamp</span></a><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span class="hs-comment">-- | timestamptz</span><span>
</span><a name="line-467"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#ZonedTimestamp"><span class="hs-identifier hs-type">ZonedTimestamp</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-468"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#timestamptzOid"><span class="hs-identifier hs-var">TI.timestamptzOid</span></a><span> </span><span class="hs-string">&quot;ZonedTimestamp&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseZonedTimestamp"><span class="hs-identifier hs-var">parseZonedTimestamp</span></a><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span class="hs-comment">-- | timestamp</span><span>
</span><a name="line-471"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#LocalTimestamp"><span class="hs-identifier hs-type">LocalTimestamp</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-472"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#timestampOid"><span class="hs-identifier hs-var">TI.timestampOid</span></a><span> </span><span class="hs-string">&quot;LocalTimestamp&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseLocalTimestamp"><span class="hs-identifier hs-var">parseLocalTimestamp</span></a><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-comment">-- | date</span><span>
</span><a name="line-475"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#Date"><span class="hs-identifier hs-type">Date</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-476"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier hs-var">ff</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#dateOid"><span class="hs-identifier hs-var">TI.dateOid</span></a><span> </span><span class="hs-string">&quot;Date&quot;</span><span> </span><a href="Database.PostgreSQL.Simple.Time.Implementation.html#parseDate"><span class="hs-identifier hs-var">parseDate</span></a><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span class="hs-identifier">ff</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">B8.ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="#local-6989586621679137967"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">B8.ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="#local-6989586621679137967"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-480"></a><a name="ff"><a href="Database.PostgreSQL.Simple.FromField.html#ff"><span class="hs-identifier">ff</span></a></a><span> </span><a name="local-6989586621679138002"><a href="#local-6989586621679138002"><span class="hs-identifier">compatOid</span></a></a><span> </span><a name="local-6989586621679138003"><a href="#local-6989586621679138003"><span class="hs-identifier">hsType</span></a></a><span> </span><a name="local-6989586621679138004"><a href="#local-6989586621679138004"><span class="hs-identifier">parseBS</span></a></a><span> </span><a name="local-6989586621679138005"><a href="#local-6989586621679138005"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679138006"><a href="#local-6989586621679138006"><span class="hs-identifier">mstr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-481"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679138005"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679138002"><span class="hs-identifier hs-var">compatOid</span></a><span>
</span><a name="line-482"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679138007"><span class="hs-identifier hs-var">err</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-483"></a><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679138006"><span class="hs-identifier hs-var">mstr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-484"></a><span>         </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679138007"><span class="hs-identifier hs-var">err</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-485"></a><span>         </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679138011"><a href="#local-6989586621679138011"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679138004"><span class="hs-identifier hs-var">parseBS</span></a><span> </span><a href="#local-6989586621679138011"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-486"></a><span>                       </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679138012"><a href="#local-6989586621679138012"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679138007"><span class="hs-identifier hs-var">err</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679138012"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-487"></a><span>                       </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679138013"><a href="#local-6989586621679138013"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679138013"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-488"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-489"></a><span>   </span><a name="local-6989586621679138007"><a href="#local-6989586621679138007"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-6989586621679138008"><a href="#local-6989586621679138008"><span class="hs-identifier">errC</span></a></a><span> </span><a name="local-6989586621679138009"><a href="#local-6989586621679138009"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-490"></a><span>     </span><a name="local-6989586621679138010"><a href="#local-6989586621679138010"><span class="hs-identifier">typnam</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typename"><span class="hs-identifier hs-var">typename</span></a><span> </span><a href="#local-6989586621679138005"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-491"></a><span>     </span><a href="Database.PostgreSQL.Simple.FromField.html#left"><span class="hs-identifier hs-var">left</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679138008"><span class="hs-identifier hs-var">errC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">B8.unpack</span><span> </span><a href="#local-6989586621679138010"><span class="hs-identifier hs-var">typnam</span></a><span class="hs-special">)</span><span>
</span><a name="line-492"></a><span>                 </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#tableOid"><span class="hs-identifier hs-var">tableOid</span></a><span> </span><a href="#local-6989586621679138005"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-493"></a><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">B8.unpack</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#name"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679138005"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-494"></a><span>                 </span><a href="#local-6989586621679138003"><span class="hs-identifier hs-var">hsType</span></a><span>
</span><a name="line-495"></a><span>                 </span><a href="#local-6989586621679138009"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-496"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">ff</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-497"></a><span>
</span><a name="line-498"></a><span class="hs-comment">-- | Compatible with both types.  Conversions to type @b@ are</span><span>
</span><a name="line-499"></a><span class="hs-comment">--   preferred,  the conversion to type @a@ will be tried after</span><span>
</span><a name="line-500"></a><span class="hs-comment">--   the 'Right' conversion fails.</span><span>
</span><a name="line-501"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="#local-6989586621679135287"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="#local-6989586621679135288"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679135287"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679135288"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-502"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135289"><a href="#local-6989586621679135289"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135290"><a href="#local-6989586621679135290"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135289"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135290"><span class="hs-identifier hs-var">dat</span></a><span class="hs-special">)</span><span>
</span><a name="line-503"></a><span>                    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span>  </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135289"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135290"><span class="hs-identifier hs-var">dat</span></a><span class="hs-special">)</span><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><span class="hs-comment">-- | any postgresql array whose elements are compatible with type @a@</span><span>
</span><a name="line-506"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="#local-6989586621679135286"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679135286"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.Types.html#PGArray"><span class="hs-identifier hs-type">PGArray</span></a><span> </span><a href="#local-6989586621679135286"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-507"></a><span>  </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#pgArrayFieldParser"><span class="hs-identifier hs-var">pgArrayFieldParser</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span class="hs-identifier">pgArrayFieldParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679137966"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a><span> </span><a href="#local-6989586621679137966"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.Types.html#PGArray"><span class="hs-identifier hs-type">PGArray</span></a><span> </span><a href="#local-6989586621679137966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-510"></a><a name="pgArrayFieldParser"><a href="Database.PostgreSQL.Simple.FromField.html#pgArrayFieldParser"><span class="hs-identifier">pgArrayFieldParser</span></a></a><span> </span><a name="local-6989586621679138014"><a href="#local-6989586621679138014"><span class="hs-identifier">fieldParser</span></a></a><span> </span><a name="local-6989586621679138015"><a href="#local-6989586621679138015"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679138016"><a href="#local-6989586621679138016"><span class="hs-identifier">mdat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-511"></a><span>        </span><a name="local-6989586621679138017"><a href="#local-6989586621679138017"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typeInfo"><span class="hs-identifier hs-var">typeInfo</span></a><span> </span><a href="#local-6989586621679138015"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-512"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679138017"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-513"></a><span>          </span><a href="Database.PostgreSQL.Simple.TypeInfo.Types.html#Array"><span class="hs-identifier hs-var">TI.Array</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-514"></a><span>              </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679138016"><span class="hs-identifier hs-var">mdat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-515"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><a href="#local-6989586621679138015"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-516"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679138018"><a href="#local-6989586621679138018"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-517"></a><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">parseOnly</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#fromArray"><span class="hs-identifier hs-var">fromArray</span></a><span> </span><a href="#local-6989586621679138014"><span class="hs-identifier hs-var">fieldParser</span></a><span> </span><a href="#local-6989586621679138017"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679138015"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679138018"><span class="hs-identifier hs-var">dat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-518"></a><span>                     </span><span class="hs-identifier hs-var">Left</span><span>  </span><a name="local-6989586621679138019"><a href="#local-6989586621679138019"><span class="hs-identifier">err</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679138015"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679138019"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-519"></a><span>                     </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679138020"><a href="#local-6989586621679138020"><span class="hs-identifier">conv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Types.html#PGArray"><span class="hs-identifier hs-var">PGArray</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679138020"><span class="hs-identifier hs-var">conv</span></a><span>
</span><a name="line-520"></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679138015"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span class="hs-identifier">fromArray</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a><span> </span><a href="#local-6989586621679137965"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Types.html#TypeInfo"><span class="hs-identifier hs-type">TypeInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679137965"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-523"></a><a name="fromArray"><a href="Database.PostgreSQL.Simple.FromField.html#fromArray"><span class="hs-identifier">fromArray</span></a></a><span> </span><a name="local-6989586621679138021"><a href="#local-6989586621679138021"><span class="hs-identifier">fieldParser</span></a></a><span> </span><a name="local-6989586621679138022"><a href="#local-6989586621679138022"><span class="hs-identifier">typInfo</span></a></a><span> </span><a name="local-6989586621679138023"><a href="#local-6989586621679138023"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sequence</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679138026"><span class="hs-identifier hs-var">parseIt</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Arrays.html#array"><span class="hs-identifier hs-var">array</span></a><span> </span><a href="#local-6989586621679138024"><span class="hs-identifier hs-var">delim</span></a><span>
</span><a name="line-524"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-525"></a><span>    </span><a name="local-6989586621679138024"><a href="#local-6989586621679138024"><span class="hs-identifier">delim</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">typdelim</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typelem</span><span> </span><a href="#local-6989586621679138022"><span class="hs-identifier hs-var">typInfo</span></a><span class="hs-special">)</span><span>
</span><a name="line-526"></a><span>    </span><a name="local-6989586621679138025"><a href="#local-6989586621679138025"><span class="hs-identifier">fElem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679138023"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">typeOid</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">typoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typelem</span><span> </span><a href="#local-6989586621679138022"><span class="hs-identifier hs-var">typInfo</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span>    </span><a name="local-6989586621679138026"><a href="#local-6989586621679138026"><span class="hs-identifier">parseIt</span></a></a><span> </span><a name="local-6989586621679138027"><a href="#local-6989586621679138027"><span class="hs-identifier">item</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-529"></a><span>        </span><a href="#local-6989586621679138021"><span class="hs-identifier hs-var">fieldParser</span></a><span> </span><a href="#local-6989586621679138029"><span class="hs-identifier hs-var">f'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679138027"><span class="hs-identifier hs-var">item</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Database.PostgreSQL.Simple.Arrays.html#Plain"><span class="hs-identifier hs-var">Arrays.Plain</span></a><span> </span><span class="hs-string">&quot;NULL&quot;</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679138028"><span class="hs-identifier hs-var">item'</span></a><span>
</span><a name="line-530"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-531"></a><span>        </span><a name="local-6989586621679138028"><a href="#local-6989586621679138028"><span class="hs-identifier">item'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Arrays.html#fmt"><span class="hs-identifier hs-var">fmt</span></a><span> </span><a href="#local-6989586621679138024"><span class="hs-identifier hs-var">delim</span></a><span> </span><a href="#local-6989586621679138027"><span class="hs-identifier hs-var">item</span></a><span>
</span><a name="line-532"></a><span>        </span><a name="local-6989586621679138029"><a href="#local-6989586621679138029"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Database.PostgreSQL.Simple.Arrays.html#Array"><span class="hs-identifier hs-var">Arrays.Array</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679138027"><span class="hs-identifier hs-var">item</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679138023"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-533"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679138025"><span class="hs-identifier hs-var">fElem</span></a><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="#local-6989586621679135283"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679135283"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-6989586621679135283"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-536"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135284"><a href="#local-6989586621679135284"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135285"><a href="#local-6989586621679135285"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">fromPGArray</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135284"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135285"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="#local-6989586621679135280"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679135280"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IOVector</span><span> </span><a href="#local-6989586621679135280"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-539"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135281"><a href="#local-6989586621679135281"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135282"><a href="#local-6989586621679135282"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#liftConversion"><span class="hs-identifier hs-var">liftConversion</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.unsafeThaw</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135281"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135282"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-comment">-- | uuid</span><span>
</span><a name="line-542"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">UUID</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-543"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135276"><a href="#local-6989586621679135276"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135277"><a href="#local-6989586621679135277"><span class="hs-identifier">mbs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-544"></a><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679135276"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#uuidOid"><span class="hs-identifier hs-var">TI.uuidOid</span></a><span>
</span><a name="line-545"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679135276"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-546"></a><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679135277"><span class="hs-identifier hs-var">mbs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-547"></a><span>             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><a href="#local-6989586621679135276"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-548"></a><span>             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679135278"><a href="#local-6989586621679135278"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-549"></a><span>                 </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">UUID.fromASCIIBytes</span><span> </span><a href="#local-6989586621679135278"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-550"></a><span>                   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679135276"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;Invalid UUID&quot;</span><span>
</span><a name="line-551"></a><span>                   </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679135279"><a href="#local-6989586621679135279"><span class="hs-identifier">uuid</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679135279"><span class="hs-identifier hs-var">uuid</span></a><span>
</span><a name="line-552"></a><span>
</span><a name="line-553"></a><span class="hs-comment">-- | json, jsonb</span><span>
</span><a name="line-554"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-identifier hs-type">JSON.Value</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-555"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135140"><a href="#local-6989586621679135140"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135141"><a href="#local-6989586621679135141"><span class="hs-identifier">mbs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679135142"><span class="hs-identifier hs-var">parseBS</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromFieldJSONByteString"><span class="hs-identifier hs-var">fromFieldJSONByteString</span></a><span> </span><a href="#local-6989586621679135140"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135141"><span class="hs-identifier hs-var">mbs</span></a><span>
</span><a name="line-556"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679135142"><a href="#local-6989586621679135142"><span class="hs-identifier">parseBS</span></a></a><span> </span><a name="local-6989586621679135143"><a href="#local-6989586621679135143"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">parseOnly</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">JSON.value'</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><span class="hs-identifier hs-var">endOfInput</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679135143"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-557"></a><span>                   </span><span class="hs-identifier hs-var">Left</span><span>  </span><a name="local-6989586621679135274"><a href="#local-6989586621679135274"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679135140"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135274"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-558"></a><span>                   </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679135275"><a href="#local-6989586621679135275"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679135275"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-559"></a><span>
</span><a name="line-560"></a><span class="hs-comment">-- | Return the JSON ByteString directly</span><span>
</span><a name="line-561"></a><span class="hs-identifier">fromFieldJSONByteString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-562"></a><a name="fromFieldJSONByteString"><a href="Database.PostgreSQL.Simple.FromField.html#fromFieldJSONByteString"><span class="hs-identifier">fromFieldJSONByteString</span></a></a><span> </span><a name="local-6989586621679138030"><a href="#local-6989586621679138030"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679138031"><a href="#local-6989586621679138031"><span class="hs-identifier">mbs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-563"></a><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679138030"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#jsonOid"><span class="hs-identifier hs-var">TI.jsonOid</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679138030"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#jsonbOid"><span class="hs-identifier hs-var">TI.jsonbOid</span></a><span>
</span><a name="line-564"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679138030"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-565"></a><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679138031"><span class="hs-identifier hs-var">mbs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-566"></a><span>             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><a href="#local-6989586621679138030"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-567"></a><span>             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679138032"><a href="#local-6989586621679138032"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679138032"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-comment">-- | Parse a field to a JSON 'JSON.Value' and convert that into a</span><span>
</span><a name="line-570"></a><span class="hs-comment">-- Haskell value using the 'JSON.FromJSON' instance.</span><span>
</span><a name="line-571"></a><span class="hs-comment">--</span><span>
</span><a name="line-572"></a><span class="hs-comment">-- This can be used as the default implementation for the 'fromField'</span><span>
</span><a name="line-573"></a><span class="hs-comment">-- method for Haskell types that have a JSON representation in</span><span>
</span><a name="line-574"></a><span class="hs-comment">-- PostgreSQL.</span><span>
</span><a name="line-575"></a><span class="hs-comment">--</span><span>
</span><a name="line-576"></a><span class="hs-comment">-- The 'Typeable' constraint is required to show more informative</span><span>
</span><a name="line-577"></a><span class="hs-comment">-- error messages when parsing fails.</span><span>
</span><a name="line-578"></a><span class="hs-comment">--</span><span>
</span><a name="line-579"></a><span class="hs-comment">-- Note that @fromJSONField :: FieldParser ('Maybe' Foo)@ will return</span><span>
</span><a name="line-580"></a><span class="hs-comment">-- @'Nothing'@ on the json @null@ value, and return an exception on SQL @null@</span><span>
</span><a name="line-581"></a><span class="hs-comment">-- value.  Alternatively,  one could write @'optionalField' fromJSONField@</span><span>
</span><a name="line-582"></a><span class="hs-comment">-- that will return @Nothing@ on SQL @null@,  and otherwise will call</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- @fromJSONField :: FieldParser Foo@ and then return @'Just'@ the</span><span>
</span><a name="line-584"></a><span class="hs-comment">-- result value,  or return its exception.  If one would</span><span>
</span><a name="line-585"></a><span class="hs-comment">-- like to return @Nothing@ on both the SQL @null@ and json @null@ values,</span><span>
</span><a name="line-586"></a><span class="hs-comment">-- one way to do it would be to write</span><span>
</span><a name="line-587"></a><span class="hs-comment">-- @\\f mv -&gt; 'Control.Monad.join' '&lt;$&gt;' optionalField fromJSONField f mv@</span><span>
</span><a name="line-588"></a><span class="hs-identifier">fromJSONField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">JSON.FromJSON</span><span> </span><a href="#local-6989586621679135331"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679135331"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a><span> </span><a href="#local-6989586621679135331"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-589"></a><a name="fromJSONField"><a href="Database.PostgreSQL.Simple.FromField.html#fromJSONField"><span class="hs-identifier">fromJSONField</span></a></a><span> </span><a name="local-6989586621679138033"><a href="#local-6989586621679138033"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679138034"><a href="#local-6989586621679138034"><span class="hs-identifier">mbBs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-590"></a><span>    </span><a name="local-6989586621679138035"><a href="#local-6989586621679138035"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679138033"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679138034"><span class="hs-identifier hs-var">mbBs</span></a><span>
</span><a name="line-591"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">JSON.ifromJSON</span><span> </span><a href="#local-6989586621679138035"><span class="hs-identifier hs-var">value</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-592"></a><span>        </span><span class="hs-identifier hs-var">JSON.IError</span><span> </span><a name="local-6989586621679138036"><a href="#local-6989586621679138036"><span class="hs-identifier">path</span></a></a><span> </span><a name="local-6989586621679138037"><a href="#local-6989586621679138037"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679138033"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-593"></a><span>                            </span><span class="hs-string">&quot;JSON decoding error: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">JSON.formatError</span><span> </span><a href="#local-6989586621679138036"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="#local-6989586621679138037"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-594"></a><span>        </span><span class="hs-identifier hs-var">JSON.ISuccess</span><span> </span><a name="local-6989586621679138038"><a href="#local-6989586621679138038"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679138038"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-595"></a><span>
</span><a name="line-596"></a><span class="hs-comment">-- | Compatible with the same set of types as @a@.  Note that</span><span>
</span><a name="line-597"></a><span class="hs-comment">--   modifying the 'IORef' does not have any effects outside</span><span>
</span><a name="line-598"></a><span class="hs-comment">--   the local process on the local machine.</span><span>
</span><a name="line-599"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="#local-6989586621679135137"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="#local-6989586621679135137"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-600"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135138"><a href="#local-6989586621679135138"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135139"><a href="#local-6989586621679135139"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#liftConversion"><span class="hs-identifier hs-var">liftConversion</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135138"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135139"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-601"></a><span>
</span><a name="line-602"></a><span class="hs-comment">-- | Compatible with the same set of types as @a@.  Note that</span><span>
</span><a name="line-603"></a><span class="hs-comment">--   modifying the 'MVar' does not have any effects outside</span><span>
</span><a name="line-604"></a><span class="hs-comment">--   the local process on the local machine.</span><span>
</span><a name="line-605"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><a href="#local-6989586621679135134"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#FromField"><span class="hs-identifier hs-type">FromField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="#local-6989586621679135134"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-606"></a><span>    </span><a name="local-8214565720323910002"><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier">fromField</span></a></a><span> </span><a name="local-6989586621679135135"><a href="#local-6989586621679135135"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679135136"><a href="#local-6989586621679135136"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#liftConversion"><span class="hs-identifier hs-var">liftConversion</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">newMVar</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#fromField"><span class="hs-identifier hs-var">fromField</span></a><span> </span><a href="#local-6989586621679135135"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135136"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-607"></a><span>
</span><a name="line-608"></a><span class="hs-keyword">type</span><span> </span><a name="Compat"><a href="Database.PostgreSQL.Simple.FromField.html#Compat"><span class="hs-identifier">Compat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-identifier">okText</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">okText'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">okBinary</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ok16</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ok32</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ok64</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">okInt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Compat"><span class="hs-identifier hs-type">Compat</span></a><span>
</span><a name="line-611"></a><a name="okText"><a href="Database.PostgreSQL.Simple.FromField.html#okText"><span class="hs-identifier">okText</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#nameOid"><span class="hs-identifier hs-var">TI.nameOid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#textOid"><span class="hs-identifier hs-var">TI.textOid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#charOid"><span class="hs-identifier hs-var">TI.charOid</span></a><span>
</span><a name="line-612"></a><span>        </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#bpcharOid"><span class="hs-identifier hs-var">TI.bpcharOid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#varcharOid"><span class="hs-identifier hs-var">TI.varcharOid</span></a><span>
</span><a name="line-613"></a><a name="okText%27"><a href="Database.PostgreSQL.Simple.FromField.html#okText%27"><span class="hs-identifier">okText'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#nameOid"><span class="hs-identifier hs-var">TI.nameOid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#textOid"><span class="hs-identifier hs-var">TI.textOid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#charOid"><span class="hs-identifier hs-var">TI.charOid</span></a><span>
</span><a name="line-614"></a><span>        </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#bpcharOid"><span class="hs-identifier hs-var">TI.bpcharOid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#varcharOid"><span class="hs-identifier hs-var">TI.varcharOid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#unknownOid"><span class="hs-identifier hs-var">TI.unknownOid</span></a><span>
</span><a name="line-615"></a><a name="okBinary"><a href="Database.PostgreSQL.Simple.FromField.html#okBinary"><span class="hs-identifier">okBinary</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#byteaOid"><span class="hs-identifier hs-var">TI.byteaOid</span></a><span>
</span><a name="line-616"></a><a name="ok16"><a href="Database.PostgreSQL.Simple.FromField.html#ok16"><span class="hs-identifier">ok16</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int2Oid"><span class="hs-identifier hs-var">TI.int2Oid</span></a><span>
</span><a name="line-617"></a><a name="ok32"><a href="Database.PostgreSQL.Simple.FromField.html#ok32"><span class="hs-identifier">ok32</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int2Oid"><span class="hs-identifier hs-var">TI.int2Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int4Oid"><span class="hs-identifier hs-var">TI.int4Oid</span></a><span>
</span><a name="line-618"></a><a name="ok64"><a href="Database.PostgreSQL.Simple.FromField.html#ok64"><span class="hs-identifier">ok64</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int2Oid"><span class="hs-identifier hs-var">TI.int2Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int4Oid"><span class="hs-identifier hs-var">TI.int4Oid</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="Database.PostgreSQL.Simple.TypeInfo.Static.html#int8Oid"><span class="hs-identifier hs-var">TI.int8Oid</span></a><span>
</span><a name="line-619"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64
</span><span class="hs-identifier">okInt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ok32</span><span>
</span><a name="line-621"></a><span class="hs-cpp">#else
</span><a name="okInt"><a href="Database.PostgreSQL.Simple.FromField.html#okInt"><span class="hs-identifier">okInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ok64"><span class="hs-identifier hs-var">ok64</span></a><span>
</span><a name="line-623"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-625"></a><span class="hs-comment">-- | eq and \/ are used to imlement what Macro stuff did,</span><span>
</span><a name="line-626"></a><span class="hs-comment">-- i.e. mkCompats and inlineTypoid</span><span>
</span><a name="line-627"></a><span class="hs-identifier">eq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-628"></a><a name="eq"><a href="Database.PostgreSQL.Simple.FromField.html#eq"><span class="hs-identifier">eq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">eq</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-630"></a><span>
</span><a name="line-631"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">2</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator hs-var">\/</span></a><span>
</span><a name="line-632"></a><span class="hs-special">(</span><span class="hs-operator">\/</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-635"></a><a name="local-6989586621679138039"><a href="#local-6989586621679138039"><span class="hs-identifier">f</span></a></a><span> </span><a name="%5C%2F"><a href="Database.PostgreSQL.Simple.FromField.html#%5C%2F"><span class="hs-operator">\/</span></a></a><span> </span><a name="local-6989586621679138040"><a href="#local-6989586621679138040"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679138041"><a href="#local-6989586621679138041"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679138039"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679138041"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679138040"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679138041"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-636"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\/</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-identifier">doFromField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679135330"><a href="#local-6989586621679135330"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679135330"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Compat"><span class="hs-identifier hs-type">Compat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="#local-6989586621679135330"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-640"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="#local-6989586621679135330"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-641"></a><a name="doFromField"><a href="Database.PostgreSQL.Simple.FromField.html#doFromField"><span class="hs-identifier">doFromField</span></a></a><span> </span><a name="local-6989586621679138042"><a href="#local-6989586621679138042"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679138043"><a href="#local-6989586621679138043"><span class="hs-identifier">isCompat</span></a></a><span> </span><a name="local-6989586621679138044"><a href="#local-6989586621679138044"><span class="hs-identifier">cvt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679138045"><a href="#local-6989586621679138045"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679138043"><span class="hs-identifier hs-var">isCompat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeOid</span><span> </span><a href="#local-6989586621679138042"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679138044"><span class="hs-identifier hs-var">cvt</span></a><span> </span><a href="#local-6989586621679138045"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-643"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Incompatible"><span class="hs-identifier hs-var">Incompatible</span></a><span> </span><a href="#local-6989586621679138042"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;types incompatible&quot;</span><span>
</span><a name="line-644"></a><span class="hs-identifier">doFromField</span><span> </span><a name="local-6989586621679138046"><a href="#local-6989586621679138046"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#UnexpectedNull"><span class="hs-identifier hs-var">UnexpectedNull</span></a><span> </span><a href="#local-6989586621679138046"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-645"></a><span>
</span><a name="line-646"></a><span>
</span><a name="line-647"></a><span class="hs-comment">-- | Given one of the constructors from 'ResultError',  the field,</span><span>
</span><a name="line-648"></a><span class="hs-comment">--   and an 'errMessage',  this fills in the other fields in the</span><span>
</span><a name="line-649"></a><span class="hs-comment">--   exception value and returns it in a 'Left . SomeException'</span><span>
</span><a name="line-650"></a><span class="hs-comment">--   constructor.</span><span>
</span><a name="line-651"></a><span class="hs-identifier">returnError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679135328"><a href="#local-6989586621679135328"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679135329"><a href="#local-6989586621679135329"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679135328"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Exception</span><span> </span><a href="#local-6989586621679135329"><span class="hs-identifier hs-type">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-652"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">PQ.Oid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679135329"><span class="hs-identifier hs-type">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-653"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="#local-6989586621679135328"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-654"></a><a name="returnError"><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier">returnError</span></a></a><span> </span><a name="local-6989586621679138047"><a href="#local-6989586621679138047"><span class="hs-identifier">mkErr</span></a></a><span> </span><a name="local-6989586621679138048"><a href="#local-6989586621679138048"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679138049"><a href="#local-6989586621679138049"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-655"></a><span>  </span><a name="local-6989586621679138050"><a href="#local-6989586621679138050"><span class="hs-identifier">typnam</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#typename"><span class="hs-identifier hs-var">typename</span></a><span> </span><a href="#local-6989586621679138048"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-656"></a><span>  </span><a href="Database.PostgreSQL.Simple.FromField.html#left"><span class="hs-identifier hs-var">left</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679138047"><span class="hs-identifier hs-var">mkErr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">B.unpack</span><span> </span><a href="#local-6989586621679138050"><span class="hs-identifier hs-var">typnam</span></a><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span>               </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#tableOid"><span class="hs-identifier hs-var">tableOid</span></a><span> </span><a href="#local-6989586621679138048"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-658"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">B.unpack</span><span> </span><span class="hs-special">(</span><a href="Database.PostgreSQL.Simple.FromField.html#name"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679138048"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">typeOf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679135328"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-660"></a><span>               </span><a href="#local-6989586621679138049"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-661"></a><span>
</span><a name="line-662"></a><span class="hs-identifier">atto</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679135327"><a href="#local-6989586621679135327"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679135327"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#Compat"><span class="hs-identifier hs-type">Compat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="#local-6989586621679135327"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-664"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="#local-6989586621679135327"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-665"></a><a name="atto"><a href="Database.PostgreSQL.Simple.FromField.html#atto"><span class="hs-identifier">atto</span></a></a><span> </span><a name="local-6989586621679138051"><a href="#local-6989586621679138051"><span class="hs-identifier">types</span></a></a><span> </span><a name="local-6989586621679138052"><a href="#local-6989586621679138052"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679138053"><a href="#local-6989586621679138053"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679138054"><a href="#local-6989586621679138054"><span class="hs-identifier">dat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#doFromField"><span class="hs-identifier hs-var">doFromField</span></a><span> </span><a href="#local-6989586621679138053"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679138051"><span class="hs-identifier hs-var">types</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679138055"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679138052"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679138054"><span class="hs-identifier hs-var">dat</span></a><span>
</span><a name="line-666"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-667"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="#local-6989586621679135327"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.Internal.html#Conversion"><span class="hs-identifier hs-type">Conversion</span></a><span> </span><a href="#local-6989586621679135327"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-668"></a><span>    </span><a name="local-6989586621679138055"><a href="#local-6989586621679138055"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679138056"><a href="#local-6989586621679138056"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679138057"><a href="#local-6989586621679138057"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-669"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">parseOnly</span><span> </span><a href="#local-6989586621679138056"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679138057"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-670"></a><span>          </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679138058"><a href="#local-6989586621679138058"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#returnError"><span class="hs-identifier hs-var">returnError</span></a><span> </span><a href="Database.PostgreSQL.Simple.FromField.html#ConversionFailed"><span class="hs-identifier hs-var">ConversionFailed</span></a><span> </span><a href="#local-6989586621679138053"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679138058"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-671"></a><span>          </span><span class="hs-identifier hs-var">Right</span><span>  </span><a name="local-6989586621679138059"><a href="#local-6989586621679138059"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679138059"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-672"></a></pre></body></html>